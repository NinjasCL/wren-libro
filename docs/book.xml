<?xml version="1.0" encoding="UTF-8"?>
<?asciidoc-toc maxdepth="3"?>
<?asciidoc-numbered?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xl="http://www.w3.org/1999/xlink" version="5.0" xml:lang="es">
<info>
<title>El <emphasis>Wren</emphasis> libro</title>
<date>2020-12-27</date>
<copyright>
<holder>CC-BY-NC-SA 4.0</holder>
</copyright>
<author>
<personname>
<firstname>Camilo</firstname>
<othername>A.</othername>
<surname>Castro</surname>
</personname>
<email>https://github.com/clsource[@clsource]</email>
</author>
<authorinitials>CAC</authorinitials>
<cover role="front">
<mediaobject>
<imageobject>
<imagedata fileref="images/default-cover.png"/>
</imageobject>
</mediaobject>
</cover>
</info>
<preface>
<title></title>
<abstract>
<simpara>En este peque√±o documento se detallar√°n lo b√°sico del lenguaje de programaci√≥n <link xl:href="http://wren.io">Wren</link>.</simpara>
</abstract>
</preface>
<preface xml:id="_prefacio">
<title>Prefacio</title>

</preface>
<dedication xml:id="_dedicatoria">
<title>Dedicatoria</title>

</dedication>
<chapter xml:id="_peque√±a_historia_de_wren">
<title>Peque√±a Historia de <link xl:href="https://github.com/wren-lang/wren"><emphasis>Wren</link></emphasis></title>
<simpara><link xl:href="https://github.com/wren-lang/wren"><emphasis>Wren</link></emphasis> es un lenguaje de programaci√≥n <link xl:href="https://es.wikipedia.org/wiki/Programaci%C3%B3n_orientada_a_objetos">orientado a objetos</link> creado por <link xl:href="http://journal.stuffwithstuff.com/">Bob Nystrom</link>, un ex desarrollador de videojuegos y creador de otros lenguajes de programaci√≥n como <link xl:href="https://github.com/munificent/vigil">Vigil</link>, <link xl:href="http://finch.stuffwithstuff.com/">Finch</link> y <link xl:href="http://magpie-lang.org/">Magpie</link>. Ha escrito dos libros: <link xl:href="http://gameprogrammingpatterns.com/">Game Programming Patterns</link> y <link xl:href="http://craftinginterpreters.com/">Crafting Interpreters</link>.</simpara>
<simpara>El primer <emphasis>commit</emphasis> de <emphasis>Wren</emphasis> fue escrito el <link xl:href="https://github.com/wren-lang/wren/tree/2f6a6889f1b4a1ba86aeb169e7398704b1ee04c0">22 de Octubre del 2013</link> y su versi√≥n m√°s reciente es la <emphasis>0.3</emphasis>. Actualmente <emphasis>Bob Nystrom</emphasis> pas√≥ a ser colaborador y la evoluci√≥n del lenguaje fue asignada a <link xl:href="https://github.com/underscorediscovery">_discovery</link> (creador del <link xl:href="https://luxeengine.com">game engine Luxe</link>).</simpara>
<simpara><emphasis>Wren</emphasis> fue creado como una alternativa a <emphasis>Lua</emphasis> y otros <link xl:href="https://en.wikipedia.org/wiki/Scripting_language">lenguajes de scripting</link> para personas que estuvieran m√°s familiarizadas con lenguajes orientados a objetos como <emphasis>Java</emphasis>, <emphasis>C#</emphasis>, o <emphasis>C++</emphasis>. Su principal foco es la simpleza.</simpara>
<simpara>La p√°gina oficial de Wren es <link xl:href="http://wren.io">Wren.io</link>.</simpara>
<simpara>La principal caracter√≠stica de <emphasis>Wren</emphasis> es ser un <emphasis role="strong">lenguaje minimalista</emphasis>. Esto significa
que no todas las ideas y utilidades ser√°n implementadas en la <emphasis>API</emphasis> oficial. Muchas
veces se tendr√° la obligaci√≥n de implementar funcionalidades adicionales que en otros
lenguajes est√°n disponibles de f√°brica. Normalmente la recomendaci√≥n es tener
una serie de archivos con utilidades a mano y si alg√∫n d√≠a son implementadas en la <emphasis>API</emphasis>
oficial, poder reemplazarlos adecuadamente.</simpara>
<section xml:id="_qu√©_es_un_wren">
<title>¬øQu√© es un <emphasis>Wren</emphasis>?</title>
<simpara><emphasis>Wren</emphasis> es un <link xl:href="https://es.wikipedia.org/wiki/Troglodytidae">tipo de ave peque√±a</link> perteneciente a la familia de los troglod√≠tidos (que habita en cavernas o cuevas). En Chile tenemos al <link xl:href="https://www.avesdechile.cl/074.htm">Cherc√°n o Chochin Criollo</link>.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77261969-2240d580-6c71-11ea-93d0-4341e82c2f92.png"/>
</imageobject>
<textobject><phrase>Chochin Criollo - Fotograf√≠a por Juan Tassara B.</phrase></textobject>
</inlinemediaobject></simpara>
<literallayout class="monospaced">Fotograf√≠a por Juan Tassara B en https://www.avesdechile.cl.</literallayout>
<simpara>Esta familia de aves se caracteriza por sus canciones elaboradas y complejas. Es uno de los m√°s queridos compositores de las aves. Sus canciones tienen una rica variedad de cromatura musical.</simpara>
<simpara>Tambi√©n son aves muy hogare√±as que prefieren quedarse en un mismo territorio a emigrar. Cuando vuelan sorprenden con la gran altura que pueden alcanzar y su rapidez. ¬°Nunca sabes en que direcci√≥n van a salir!.</simpara>
<simpara>En las tradiciones celtas, el <emphasis>Wren</emphasis> es un s√≠mbolo de vivacidad y actividad.</simpara>
</section>
<section xml:id="_por_qu√©_aprender_wren">
<title>¬øPor qu√© aprender <emphasis>Wren</emphasis>?</title>
<simpara>Existen algunos lenguajes interpretados usados para ser incrustados dentro de aplicaciones. <link xl:href="https://www.lua.org/"><emphasis>Lua</emphasis></link> es uno de los m√°s populares. Actualmente tambi√©n son populares <link xl:href="https://developer.mozilla.org/en-US/docs/Web/JavaScript"><emphasis>JavaScript</emphasis></link> o <link xl:href="https://www.python.org/"><emphasis>Python</emphasis></link>.</simpara>
<simpara><emphasis>Lua</emphasis> es genial, simple y r√°pido. Pero muchas veces su naturaleza es un poco inc√≥moda para personas m√°s acostumbaradas a lenguajes como <link xl:href="https://isocpp.org/"><emphasis>C++</emphasis></link> o <link xl:href="https://openjdk.java.net/"><emphasis>Java</emphasis></link>. La sintaxis es diferente y la sem√°ntica del modelo de objetos es algo inusual.</simpara>
<simpara><emphasis>Wren</emphasis> es una alternativa a <emphasis>Lua</emphasis> pensada para personas mas familiarizadas con lenguajes orientados a objetos.</simpara>
<simpara>Ac√° podemos comparar la implementaci√≥n de una clase llamada <emphasis>Cuenta</emphasis> entre
<emphasis>Lua</emphasis> y <emphasis>Wren</emphasis>.</simpara>
<formalpara>
<title>Lua</title>
<para>
<programlisting language="lua" linenumbering="numbered">-- cuenta.lua

Cuenta = {}
Cuenta.__index = Cuenta

function Cuenta.crear(balance)
  local cuenta = {}             -- nuevo objeto
  setmetatable(cuenta,Cuenta)   -- hacer el objeto cuenta tenga las propiedades de Cuenta
  cuenta.balance = balance      -- inicializar el objeto
  return cuenta
end

function Cuenta:retirar(monto)
  self.balance = self.balance - monto
end

-- crear y usar una Cuenta
cuenta = Cuenta.crear(1000)
cuenta:retirar(100)</programlisting>
</para>
</formalpara>
<formalpara>
<title>Wren</title>
<para>
<programlisting language="js" linenumbering="numbered">// cuenta.wren

class Cuenta {
  construct crear(balance) { _balance = balance }
  retirar(monto) { _balance = _balance - monto }
}

// crear y usar una Cuenta
var cuenta = Cuenta.crear(1000)
cuenta.retirar(100)</programlisting>
</para>
</formalpara>
<simpara>Los lenguajes orientados a objetos y clases tradicionalmente tienen una reputaci√≥n
de ser complejos. Esto es principalmente por que los lenguajes que implementan este paradigma
son complejos: <emphasis>C++</emphasis>, <emphasis>Java</emphasis>, <link xl:href="https://docs.microsoft.com/en-us/dotnet/csharp/"><emphasis>C#</emphasis></link>, <link xl:href="https://www.ruby-lang.org/en/"><emphasis>Ruby</emphasis></link> y <emphasis>Python</emphasis>.</simpara>
<simpara>Uno de los objetivos de <emphasis>Wren</emphasis> es demostrar que son dichos lenguajes los complejos, no la orientaci√≥n a objetos y clases en s√≠. <link xl:href="https://es.wikipedia.org/wiki/Smalltalk"><emphasis>Smalltalk</emphasis></link> fue uno de los precursores y la inspiraci√≥n para muchos de aquellos lenguajes. Es tan simple que toda su sintaxis puede ser escrita en una <emphasis>tarjeta kardex</emphasis>. <emphasis>Wren</emphasis> desea ser igual de minimalista, pero al mismo contar con el poder expresivo de las clases y orientaci√≥n a objetos.</simpara>
<simpara>Finalmente para responder la pregunta de <emphasis>"¬øPor qu√© aprender Wren?"</emphasis>. Principalmente por que aprender un nuevo lenguaje de programaci√≥n siempre entregar√° experiencia que puede ser extrapolada a otros √°mbitos y contextos. Tal vez sea m√°s simple de aprender un concepto en <emphasis>Wren</emphasis> que en <emphasis>Python</emphasis> o <emphasis>Lua</emphasis>. Quiz√°s un lenguaje de nicho como <emphasis>Wren</emphasis> no tenga muchas ofertas laborales que lo soliciten, pero todo lo aprendido siempre ser√° nutritivo para el desarrollo profesional.</simpara>
</section>
<section xml:id="_c√≥mo_usar_wren">
<title>¬øC√≥mo usar <emphasis>Wren</emphasis>?</title>
<simpara><emphasis>Wren</emphasis> es un lenguaje interpretado, lo que significa que no requiere de compilaci√≥n. Basta simplemente tener un int√©rprete para ejecutar los algoritmos. Hay varias alternativas.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara><link xl:href="https://github.com/wren-lang/wren">Compilar tu propio int√©rprete de <emphasis>Wren</emphasis></link>. Esta es la opci√≥n para valientes.</simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/wren-lang/wren-cli/releases">Utiliza <emphasis>Wren CLI</emphasis></link> para ejecutar archivos <emphasis>*.wren</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Utiliza un engine de juegos como <link xl:href="https://domeengine.com/"><emphasis>Dome</emphasis></link>, <link xl:href="https://tic.computer"><emphasis>TIC 80</emphasis></link> o <link xl:href="https://luxeengine.com/alpha/"><emphasis>Luxe</emphasis></link> que traen <emphasis>Wren</emphasis> listo para llegar y utilizar.</simpara>
</listitem>
<listitem>
<simpara>Utiliza <link xl:href="https://wren.io/try/"><emphasis>Wren Try</emphasis></link> para probar el lenguaje en tu navegador.</simpara>
</listitem>
</orderedlist>
<simpara>Una vez que tengas tu int√©rprete instalado puedes ejecutar por ejemplo`./wren main.wren` para ver el resultado de tu script.</simpara>
</section>
<section xml:id="_wren_cli">
<title><link xl:href="https://github.com/wren-lang/wren-cli">Wren CLI</link></title>
<simpara>La terminal de <emphasis>Wren</emphasis> llamada <emphasis>Wren CLI</emphasis> (<link xl:href="https://es.wikipedia.org/wiki/Interfaz_de_l%C3%ADnea_de_comandos">Interfaz de l√≠nea de comandos</link>) permite dos modos de operaci√≥n. El primero es el modo <link xl:href="https://es.wikipedia.org/wiki/REPL"><emphasis>REPL</emphasis></link> (Bucle Lectura-Evaluaci√≥n-Impresi√≥n) el cual nos permite evaluar las instrucciones una a una. El segundo modo es el int√©rprete que permite ejecutar scripts <emphasis>Wren</emphasis>.</simpara>
<simpara>Si ejecutamos simplemente el comando <literal>./wren</literal> entraremos al modo <emphasis>REPL</emphasis>. Donde se nos mostrar√° un simp√°tico pajarito y la versi√≥n de <emphasis>Wren</emphasis> instalada.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77837383-22444800-713f-11ea-8db4-3f404faabc10.png"/>
</imageobject>
<textobject><phrase>Wren CLI</phrase></textobject>
</inlinemediaobject></simpara>
<section xml:id="_operaciones_matem√°ticas">
<title>Operaciones Matem√°ticas</title>
<simpara>Podremos ejecutar operaciones matem√°ticas como <literal>5 * 5</literal>.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77837948-7ce0a280-7145-11ea-8b43-3f91f7491b35.png"/>
</imageobject>
<textobject><phrase>5 * 5</phrase></textobject>
</inlinemediaobject></simpara>
</section>
<section xml:id="_system_print">
<title>System.print()</title>
<simpara>O Tambi√©n mostrar un mensaje utilizando <literal>System.print()</literal>.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77837982-d517a480-7145-11ea-86f4-7a24e5ecc628.png"/>
</imageobject>
<textobject><phrase>System.print()</phrase></textobject>
</inlinemediaobject></simpara>
<simpara>¬øPor qu√© aparece la palabra <literal>Plop!</literal> dos veces?. Simplemente por que la primera vez es el resultado de la operaci√≥n <literal>System.print()</literal> (mostrar un valor), mientras que la segunda vez est√° mostrando el valor retornado por <literal>System.print()</literal>, el cual es el mismo texto.</simpara>
</section>
<section xml:id="_errores">
<title>Errores</title>
<simpara>Si cometemos alg√∫n error <emphasis>Wren CLI</emphasis> nos avisar√° con un bonito mensaje.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77838174-c4682e00-7147-11ea-9e82-ffd2dc4dd1f9.png"/>
</imageobject>
<textobject><phrase>Error</phrase></textobject>
</inlinemediaobject></simpara>
</section>
<section xml:id="_ejecuci√≥n_de_archivos">
<title>Ejecuci√≥n de archivos</title>
<simpara>Cuando necesitamos algo mucho m√°s avanzado podemos utilizar archivos que finalicen con la extensi√≥n <emphasis>*.wren</emphasis>. El nombre m√°s com√∫n es <emphasis>main.wren</emphasis>, aunque puedes llamarlo con cualquier nombre. Para ejecutar un archivo espec√≠fico simplemente se debe utilizar <literal>./wren &lt;archivo.wren&gt;</literal>.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Creamos un nuevo archivo llamado <literal>main.wren</literal>.</simpara>
</listitem>
<listitem>
<simpara>Escribimos nuestro c√≥digo (En este caso <literal>System.print("Plop!")</literal>) y guardamos.</simpara>
</listitem>
<listitem>
<simpara>Finalmente Ejecutamos <literal>./wren main.wren</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>Deber√≠amos ver un resultado similar a este:</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77839010-7c4d0980-714f-11ea-90df-4330a821d207.png"/>
</imageobject>
<textobject><phrase>Plop!</phrase></textobject>
</inlinemediaobject></simpara>
<simpara>Notar como solamente aparece una vez "Plop!", ya que no estamos en modalidad <emphasis>REPL</emphasis>.</simpara>
</section>
<section xml:id="_c√≥digos_de_salida_exit_code">
<title>C√≥digos de salida (Exit code)</title>
<simpara>Cada vez que un programa termina su ejecuci√≥n devuelve un c√≥digo num√©rico para indicar si termin√≥ exitosamente o tuvo un alg√∫n tipo de error mientras se ejecutaba.</simpara>
<simpara>La convenci√≥n tradicional es considerar el c√≥digo cero (0) como √©xito y cualquier otro n√∫mero como error. No hay un est√°ndar definido para la asignaci√≥n de n√∫meros de error. <emphasis>Wren</emphasis> se basa levemente en los c√≥digos utilizados por el sistema operativo <link xl:href="https://github.com/openbsd/src/blob/master/include/sysexits.h"><emphasis>BSD</emphasis></link>.</simpara>
<simpara>Actualmente no puedes elegir el c√≥digo de error. <emphasis>Wren</emphasis> autom√°ticamente asignar√° el c√≥digo que mejor se ajuste a la situaci√≥n. Por ejemplo si utilizar la instrucci√≥n para terminar la ejecuci√≥n del programa <literal>Fiber.abort("Mensaje de Error")</literal> el c√≥digo asignado sera de 70 (error interno del software).</simpara>
<simpara>La siguiente es una tabla con los c√≥digos de BSD m√°s algunos otros adicionales.</simpara>
<screen linenumbering="numbered">0 - Fin del programa exitoso
1 - Error desconocido
2 - (grep) Uso incorrecto del comando | (bash) Error de entrada/salida
64 - Uso incorrecto del comando
65 - Error de formato de datos
66 - Sin acceso a la entrada
67 - Direcci√≥n desconocida
68 - Nombre de dominio (host name) desconocido
69 - Servicio no disponible
70 - Error interno del software
71 - Error de sistema
72 - Archivo cr√≠tico del sistema no encontrado
73 - Imposible de crear archivo de salida
74 - Error de entrada/salida
75 - Falla temporal
76 - Error remoto en protocolo
77 - Permiso denegado
78 - Error de configuraci√≥n
126 - Comando encontrado, pero no es ejecutable
127 - Comando no encontrado
128 - C√≥digo de salida no v√°lido
128   Error fatal terminado por kill -9
140 - Comando terminado por Ctrl-C
141 - Comando terminado por Ctrl-D
255 - C√≥digo de salida fuera de rango</screen>
<simpara>Esta es la lista de los errores <link xl:href="https://raw.githubusercontent.com/wren-lang/wren/58611240e75522df1a17ba29d8fd2109b4d2f657/test/test.h">usados en <emphasis>Wren</emphasis></link>:</simpara>
<programlisting language="c" linenumbering="numbered">// Exit codes used by the wren binaries, following the BSD standard
//
// The interpreter was used with an incorrect number of arguments
#define WREN_EX_USAGE 64

// Compilation error
#define WREN_EX_DATAERR 65

// Runtime error
#define WREN_EX_SOFTWARE 70

// Cannot open input file
#define WREN_EX_NOINPUT 66

// I/O Error
#define WREN_EX_IOERR 74</programlisting>
<simpara>Puedes verificar el c√≥digo num√©rico de salida utilizando el siguiente comando (bash)</simpara>
<simpara><literal>./wren main.wren | echo "Exit code ${PIPESTATUS[0]}"</literal></simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://user-images.githubusercontent.com/292738/77839414-d9968a00-7152-11ea-9bd3-b42ff06a4d1a.png"/>
</imageobject>
<textobject><phrase>Exit Code 0</phrase></textobject>
</inlinemediaobject></simpara>
</section>
</section>
<section xml:id="_ejercicios">
<title>Ejercicios</title>
<section xml:id="chap1-ex1">
<title>¬°Hola Wren!</title>
<simpara>Es una <link xl:href="https://es.wikipedia.org/wiki/Hola_mundo">tradici√≥n</link> que cuando se est√© aprendiendo
un lenguaje de programaci√≥n se escriba una variante
del mensaje "!Hola mundo¬°". Este es un programa
muy simple que permite verificar que tu computadora
esta correctamente configurada para correr programas
en <emphasis>Wren</emphasis>.</simpara>
<simpara>Para este ejercicio simplemente se debe crear un nuevo
archivo llamado <literal>hola.wren</literal> con una √∫nica instrucci√≥n
que muestre el mensaje "¬°Hola Wren!".</simpara>
<simpara>Luego ejecutar el programa utilizando el int√©rprete de <emphasis>Wren</emphasis>.</simpara>
<formalpara>
<title>Ejecuci√≥n</title>
<para><literal>$ ./wren hola.wren</literal></para>
</formalpara>
<formalpara>
<title>Salida</title>
<para>
<screen linenumbering="numbered">¬°Hola Wren!</screen>
</para>
</formalpara>
<formalpara>
<title>C√≥digo</title>
<para>
<programlisting language="js" linenumbering="numbered">// muestra: ¬°Hola Wren!</programlisting>
</para>
</formalpara>
<formalpara>
<title>Soluci√≥n</title>
<para><xref linkend="chap1-ex1-sol"/></para>
</formalpara>
</section>
</section>
</chapter>
<chapter xml:id="_nociones_b√°sicas">
<title>Nociones B√°sicas</title>
<simpara>Todo lenguaje de programaci√≥n define estructuras base que
determinan la forma de escribir el lenguaje. El siguiente
cap√≠tulo detalla las normas b√°sicas con las que funciona
<emphasis>Wren</emphasis>.</simpara>
<section xml:id="_tipos_de_datos">
<title>Tipos de datos</title>
<simpara>Todos los tipos de datos en <emphasis>Wren</emphasis> son objetos, instancias de una clase espec√≠fica. Las operaciones son m√©todos disponibles en dichas clases.</simpara>
<formalpara>
<title>Wren</title>
<para>Estas son las clases disponibles dentro del lenguaje <emphasis>Wren</emphasis> "vainilla".</para>
</formalpara>
<orderedlist numeration="arabic">
<listitem>
<simpara><emphasis>Bool</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Class</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Fiber</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Fn</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>List</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Map</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Null</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Num</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Object</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Range</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Sequence</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>String</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>System</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Meta</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Random</emphasis></simpara>
</listitem>
</orderedlist>
<formalpara>
<title>Importante</title>
<para>No se puede heredar desde estas clases debido al problema de <link xl:href="https://es.wikipedia.org/wiki/Reentrancia_(inform%C3%A1tica)"><emphasis>Reentrancia</emphasis></link> (<emphasis>Wren</emphasis> no tiene esta capacidad). Para extender solo es posible usando la composici√≥n (Crear una nueva clase). Esto significa que al llamar a un m√©todo de una clase que herede de un tipo base, la m√°quina virtual no podr√° diferenciar los m√©todos (Ya que son clases creadas con c√≥digo de bajo nivel), lo que puede causar errores, por esta raz√≥n no est√° permitido heredar de las clases primitivas.</para>
</formalpara>
<formalpara>
<title>Wren CLI</title>
<para>Estas clases son exclusivas de la <emphasis>Wren CLI</emphasis>. No estar√°n disponibles fuera del entorno de ejecuci√≥n de este int√©rprete de <emphasis>Wren</emphasis>.</para>
</formalpara>
<orderedlist numeration="arabic">
<listitem>
<simpara><emphasis>Directory</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>File</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Stat</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Stdin</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Stdout</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Platform</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Process</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Scheduler</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis>Timer</emphasis></simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="_variables">
<title>Variables</title>
<simpara>Una variable es un contenedor de un valor espec√≠fico.
Este valor puede ser una cadena de caracteres, n√∫merico, booleano u otro tipo de objeto.</simpara>
<programlisting language="js" linenumbering="numbered">var mensaje = "Hola mundo Wren"
System.print(mensaje)</programlisting>
<simpara>Se puede modificar el valor posteriormente</simpara>
<programlisting language="js" linenumbering="numbered">var mensaje = "Hola mundo Wren"
System.print(mensaje)

mensaje = "El cherc√°n es una bonita ave"
System.print(mensaje)</programlisting>
<simpara>Si usamos una variable sin haberla declarado antes
recibiremos un error similar a lo siguiente:</simpara>
<programlisting language="js" linenumbering="numbered">var mensaje = "Hola"
System.print(mensaj)
[repl line 1] Error at 'mensaj': Variable is used but not defined.</programlisting>
<simpara>Debemos siempre procurar que todas nuestras variables est√©n declaradas
dentro del contexto y que no existan errores de escritura en sus nombres.</simpara>
</section>
<section xml:id="_identificadores">
<title>Identificadores</title>
<simpara>Similar al <emphasis>Lenguaje C</emphasis>, para los indentificadores (nombres de variables, clases, metodos, funciones) se pueden utilizar los caracteres de la <link xl:href="http://www.asciitable.com/">lista <literal>ascii</literal></link> y comenzar con un caracter alfab√©tico o gui√≥n bajo. Los identificadores en <emphasis>Wren</emphasis> diferencian entre may√∫sculas y min√∫sculas. Solo se permiten letras (<literal>A - Z</literal>, <literal>a - z</literal>), n√∫meros (<literal>0 - 9</literal>) y gui√≥n bajo (<literal>_</literal>). No se permiten espacios o comenzar con un n√∫mero o gui√≥n alto (<literal>-</literal>).</simpara>
<section xml:id="_ejemplo_de_identificadores_v√°lidos">
<title>Ejemplo de Identificadores v√°lidos</title>
<programlisting language="js" linenumbering="numbered">hola
camelCase
PascalCase
_under_score
abc123
TODAS_MAYUSCULAS</programlisting>
</section>
<section xml:id="_ejemplo_de_identificadores_no_v√°lidos">
<title>Ejemplo de Identificadores no v√°lidos</title>
<screen linenumbering="numbered">13hola
mi-variable
$miVariable
mi variable
√±and√∫
üë®miMetodo
Miüë©clase</screen>
</section>
<section xml:id="_unicode">
<title>Unicode</title>
<simpara>No est√°n permitidos caracteres <link xl:href="https://es.wikipedia.org/wiki/UTF-8">UTF-8</link> como la <literal>√ë</literal> o los emojis en los identificadores. Sin embargo las <literal>Strings</literal> las soportan en su contenido sin problemas. Hay lenguajes como <link xl:href="https://swift.org/"><emphasis>Swift</emphasis></link> o <link xl:href="https://www.emojicode.org/">Emoji Code</link> que si soportan identificadores con emojis, aunque la utilidad de esta pr√°ctica es debatible.</simpara>
<formalpara>
<title>EmojiCode</title>
<para>
<screen linenumbering="numbered">üèÅ üçá
  üòÄ üî§Hello World!üî§‚ùóÔ∏è
üçâ</screen>
</para>
</formalpara>
</section>
<section xml:id="_identificadores_que_inician_con_gui√≥n_bajo">
<title>Identificadores que inician con gui√≥n bajo</title>
<simpara>Un caso especial es para los identificadores con gui√≥n bajo como <literal>_color</literal> (un gui√≥n bajo al principio) y <literal>__sabor</literal> (dos guiones bajos al principio). Con un gui√≥n bajo indica que es una propiedad de instancia, mientras que con dos guiones bajos indican que es una propiedad de clase. M√°s detalles en la secci√≥n de Clases.</simpara>
</section>
<section xml:id="_identificadores_de_clase">
<title>Identificadores de clase</title>
<simpara>Para <emphasis>Wren</emphasis> es importante que las clases comiencen
su nombre con may√∫sculas. Si bien es posible definir clases con letras min√∫sculas no es recomendable hacerlo debido a que pueden colisionar con variables dentro del contexto de clase o m√©todo.</simpara>
<simpara>Ejemplos</simpara>
<programlisting language="js" linenumbering="numbered">// Asociamos la clase `Numero` como un substituto para llamar a la clase `Num`
var Numero = Num</programlisting>
<programlisting language="js" linenumbering="numbered">// Dar√° error. No se puede heredar de las clases primitivas.
class Numero is Num {}</programlisting>
<programlisting language="js" linenumbering="numbered">// Es posible nombrar con min√∫sculas, pero puede dar
// conflictos de contexto al momento de usarlo dentro
// de una clase. (Puede hacer colisi√≥n con nombres de variable)
class numero {}</programlisting>
</section>
<section xml:id="_recomendaciones">
<title>Recomendaciones</title>
<itemizedlist>
<listitem>
<simpara>Los nombres de los identificadores deben ser descriptivos, sin ser muy largos. Ejemplo <emphasis>"ruedasMotocicleta"</emphasis> es mejor que solo "ruedas" y "numero_de_ruedas_en_una_moto".</simpara>
</listitem>
<listitem>
<simpara>La letra <emphasis>"l"</emphasis> m√≠nuscula y la letra <emphasis>"O"</emphasis> may√∫scula puede ser confundida con el n√∫mero <emphasis>"1"</emphasis> y "0" respectivamente.</simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="_saltos_de_l√≠nea">
<title>Saltos de l√≠nea</title>
<simpara><emphasis>Wren</emphasis> utiliza los saltos de l√≠nea (<literal>\n</literal>), por lo que no es necesario utilizar el punto y coma (<literal>;</literal>) para separar instrucciones. Sin embargo omite los saltos de l√≠nea si la instrucci√≥n espera m√°s informaci√≥n para ser v√°lida.</simpara>
<section xml:id="_ejemplo_lista_de_elementos">
<title>Ejemplo: Lista de elementos</title>
<programlisting language="js" linenumbering="numbered">var animales = [
  "perro",
  "gato",
  "condor",
  "huemul"
]</programlisting>
</section>
<section xml:id="_ejemplo_par√°metros_de_un_m√©todo">
<title>Ejemplo: Par√°metros de un m√©todo</title>
<programlisting language="js" linenumbering="numbered">MiClase.metodo(
  parametro1,
  parametro2,
  parametro3
)</programlisting>
</section>
<section xml:id="_ejemplo_condicionales">
<title>Ejemplo: Condicionales</title>
<simpara>Los saltos de l√≠nea son considerados en la declaraci√≥n de bloques de c√≥digo.
Por lo tanto es importante la posici√≥n de las llaves (<emphasis>"{}"</emphasis>) dentro de una instrucci√≥n.</simpara>
<programlisting language="js" linenumbering="numbered">// Correcto
if (condiccion == true) { x = 0 }</programlisting>
<programlisting language="js" linenumbering="numbered">// Correcto
if (condiccion == true)   {
  x = 0
}</programlisting>
<programlisting language="js" linenumbering="numbered">// Correcto
if (condicion == true) x = 0</programlisting>
<simpara>Si la llave no est√° presente en la misma l√≠nea, gatillar√° un error.</simpara>
<programlisting language="js" linenumbering="numbered">// Error
if (condiction == true)
{
  x = 0
}</programlisting>
</section>
<section xml:id="_ejemplo_generar_un_n√∫mero_al_azar_del_0_al_9">
<title>Ejemplo: Generar un n√∫mero al azar del 0 al 9</title>
<simpara>Al considerar los saltos de l√≠nea significativos,
provoca un comportamiento inusual al momento de llamar m√©todos.</simpara>
<literallayout class="monospaced">Los n√∫meros pseudo aleatorios son generados utilizando la clase `Random`. Para generar un n√∫mero del 0 al 9 se necesita utilizar 10, ya que el n√∫mero m√°ximo utilizado no est√° incluido dentro de la secuencia. Es decir se incluye 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 (total 10 n√∫meros) dentro de los posibles resultados.</literallayout>
<simpara>Instrucci√≥n en una sola l√≠nea.</simpara>
<programlisting language="js" linenumbering="numbered">Random.new().int(10)</programlisting>
<simpara>Esto no es v√°lido en <emphasis>Wren</emphasis> (Pero si es v√°lido en la mayor√≠a de los lenguajes de programaci√≥n).</simpara>
<programlisting language="js" linenumbering="numbered">Random
.new()
.int(10)</programlisting>
<simpara>Para ser v√°lido necesitamos poner un punto al final de la l√≠nea.</simpara>
<programlisting language="js" linenumbering="numbered">Random.
new().
int(10)</programlisting>
<simpara>Este comportamiento inusual espera ser reparado en la versi√≥n <literal>0.4</literal>.</simpara>
</section>
<section xml:id="_ejemplo_error">
<title>Ejemplo: <emphasis role="strong">Error</emphasis></title>
<simpara>La siguiente l√≠nea arroja error debido a que no tiene un salto de l√≠nea o una operaci√≥n.</simpara>
<programlisting language="js" linenumbering="numbered">Random.new().int(10) Random.new().int(10)</programlisting>
</section>
</section>
<section xml:id="_retorno_impl√≠cito">
<title>Retorno impl√≠cito</title>
<simpara>Al tener instrucciones de una sola l√≠nea, <emphasis>Wren</emphasis> asume
la existencia de una instrucci√≥n de retorno (<emphasis>"return"</emphasis>).
Si no hay un valor, se asume que el valor de retorno
es <emphasis>null</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">class Auto {
  // ruedas retornar√° siempre el valor "4"
  ruedas {4}

  // similar a ruedas, pero usando una instrucci√≥n "return" expl√≠cita
  puertas {
    return 2
  }
}</programlisting>
</section>
<section xml:id="_palabras_reservadas">
<title>Palabras Reservadas</title>
<simpara><emphasis>Wren</emphasis> es un lenguaje simple y peque√±o. Sus palabras reservadas son las siguientes:</simpara>
<programlisting language="js" linenumbering="numbered">break class construct else false for foreign if import
in is null return static super this true var while</programlisting>
<simpara>Una palabra reservada tiene un significado especial para <emphasis>Wren</emphasis>, por lo que no se recomienda usarlas para llamar a variables o clases. De esta forma se evita conflictos y confusiones.</simpara>
<section xml:id="_caracteres_significativos">
<title>Caracteres significativos</title>
<itemizedlist>
<listitem>
<simpara>Caracteres comunes (<literal>+ - * / % &lt; &gt; = ! ( ) [ ] | . " { } , &amp; ^ ? : ~ _</literal>)</simpara>
</listitem>
<listitem>
<simpara>Retorno de carro (<literal>\n</literal>)</simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="_funciones_fn">
<title>Funciones (<emphasis>Fn</emphasis>)</title>
<simpara>Las funciones en <emphasis>Wren</emphasis> son instancias de la clase <emphasis>Fn</emphasis> y deben ser llamadas utilizando su m√©todo <emphasis>call()</emphasis>. Al ser un objeto m√°s, pueden ser pasadas como par√°metros a m√©todos u otras funciones.</simpara>
<programlisting language="js" linenumbering="numbered">var mostrar = Fn.new {|parametro|
  System.print(parametro)
}

// muestra: hola
mostrar.call("hola")</programlisting>
</section>
<section xml:id="_fibras_fiber">
<title>Fibras (<emphasis>Fiber</emphasis>)</title>
<simpara>Son similares a las funciones, con la diferencia en que se ejecutar√°n en un hilo (<emphasis>thread</emphasis>) distinto. Adem√°s del m√©todo <emphasis>call()</emphasis> tienen un m√©todo <emphasis>try()</emphasis> usado normalmente para "atajar" errores.</simpara>
<programlisting language="js" linenumbering="numbered">var mostrar = Fn.new {|parametro|
  System.print(parametro)
}

// Si existe un error se almacenar√° en la variable error
var error = Fiber.new { mostrar.call("hola") }.try()</programlisting>
</section>
<section xml:id="_clases_class">
<title>Clases (<emphasis>class</emphasis>)</title>
<simpara>Las clases se declaran utilizando la palabra clave <emphasis>class</emphasis> antes del nombre.</simpara>
<programlisting language="js" linenumbering="numbered">class MiClase {}</programlisting>
<simpara>La herencia se define utilizando la palabra clave <emphasis>is</emphasis>.
Solo se heredan los m√©todos de instancia.
Propiedades de clase (__var) y de instancia (_var),
constructores y m√©todos de clase no son heredados (todos son privados).</simpara>
<programlisting language="js" linenumbering="numbered">class Animal {
  // la propiedad _nombre solo puede ser accesible
  // a clases hijos si se definen como m√©todos accesadores
  nombre {_nombre}

  // creamos un mutador de la clase
  nombre = (value) {
    _nombre = value
  }

  imprimir() {
    System.print(nombre)
  }
}

class Perro is Animal {

  imprimir() {
    System.print("imprimir en hijo")
  }

  // constructores no son heredables
  construct nuevo(nom) {
    // llamamos al m√©todo mutador de la clase padre
    this.nombre = nom

    // Usamos `super` para llamar a un m√©todo de la clase padre
    // Muestra "Joe" usando el m√©todo accesador del padre
    super.imprimir()

    // Muestra null
    System.print(_nombre)
  }
}

var perrito = Perro.nuevo("Joe")</programlisting>
<simpara>Para definir un constructor se utiliza la palabra clave <literal>construct</literal>.
Para llamar a la instancia se usa <literal>this</literal> (opcional).</simpara>
<programlisting language="js" linenumbering="numbered">class Auto {
  construct nuevo() {
    System.print(this)
  }
}</programlisting>
<simpara>Para definir un m√©todo o propiedad de clase se utiliza la palabra clave <emphasis>static</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">class Fruta {
  // accesador (getter)
  static cantidad {__cantidad}

  // mutador (setter)
  static cantidad = (value) {
    // doble gui√≥n bajo indica propiedad de clase
    __cantidad = value
  }

  // m√©todo de clase
  static comer() {
    cantidad = cantidad - 1
  }
}</programlisting>
<simpara>Para saber el padre de la clase se utiliza la propiedad <literal>supertype</literal>.
Esta propiedad debe ser llamada recursivamente para obtener el √°rbol de herencia.</simpara>
<itemizedlist>
<listitem>
<simpara>La clase primitiva base de todas es <literal>Object</literal>.</simpara>
</listitem>
<listitem>
<simpara>No se puede heredar de los primitivos como <literal>String</literal>, <literal>Num</literal>, <literal>Map</literal>, entre otros.</simpara>
</listitem>
</itemizedlist>
<programlisting language="js" linenumbering="numbered">class Animal {}

class Perro is Animal {}

System.print(Perro.supertype) // Animal

if (Perro.supertype == Animal) {
  // Perro es animal
}</programlisting>
<simpara>Si queremos saber el tipo de una <emphasis>instancia</emphasis> se puede usar <literal>is</literal>.</simpara>
<programlisting language="js" linenumbering="numbered">var perrito = Perro.new()
if (perrito is Perro) {
  // perrito es Perro
}

if (Perro is Animal) {
  // Falso, ya que son clases distintas
}</programlisting>
<itemizedlist>
<listitem>
<simpara>Las propiedades <literal>type</literal>, <literal>supertype</literal> y <literal>name</literal> vienen dentro de cada clase.</simpara>
</listitem>
<listitem>
<simpara><literal>Object</literal> es la √∫nica clase que no tiene <literal>supertype</literal>.</simpara>
</listitem>
</itemizedlist>
<programlisting language="js" linenumbering="numbered">class Animal {}

class Perro is Animal {}

System.print(Perro.name)
System.print(Perro.type)

System.print(Perro.supertype.name)
System.print(Perro.supertype.type)
System.print(Perro.supertype.supertype)

System.print(Object.supertype)</programlisting>
</section>
<section xml:id="_control_de_flujo">
<title>Control de Flujo</title>
<simpara>Existen las estructuras de control de flujo tradicionales: <emphasis>if</emphasis>, <emphasis>for</emphasis>, <emphasis>while</emphasis> y <emphasis>break</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">if (condicion) {
  // codigo
}</programlisting>
<programlisting language="js" linenumbering="numbered">while (condicion) {
  // codigo
}</programlisting>
<programlisting language="js" linenumbering="numbered">for (elemento in secuencia) {
  // codigo
  break
}</programlisting>
</section>
<section xml:id="_importar">
<title>Importar</title>
<simpara>Para separar el c√≥digo en diversos archivos esta la instrucci√≥n <literal>import</literal>.
El leer los archivos e importar su contenido depender√° del int√©rprete.</simpara>
<simpara>La instrucci√≥n <literal>import</literal> va de la mano con la palabra <literal>for</literal>.</simpara>
<programlisting language="js" linenumbering="numbered">// El m√≥dulo se llama "random" e importamos la clase "Random" que est√° dentro de este m√≥dulo
import "random" for Random</programlisting>
</section>
<section xml:id="_object">
<title><link xl:href="https://wren.io/modules/core/object.html">Object</link></title>
<simpara>Es la clase padre de todas las dem√°s clases en <emphasis>Wren</emphasis>.</simpara>
<simpara>Algunos m√©todos destacables:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>toString</literal>: Convierte el objeto a un <emphasis>String</emphasis>.</simpara>
</listitem>
<listitem>
<simpara><literal>type</literal>: Retorna la clase a la cual el pertenece el objeto.</simpara>
</listitem>
</itemizedlist>
<programlisting language="js" linenumbering="numbered">// Convertimos los datos a un String serializable
3.toString
["1",2,"tres", true].toString

// similar a "1" == "2", pero sin posibilidad de sobre escribir el operador
Object.same("1", "2")

// verificamos que la instancia pertenezca a la clase
if ("1" is String) {
  System.print("hola")
}</programlisting>
</section>
<section xml:id="_comentarios">
<title>Comentarios</title>
<simpara>Cuando se comienza a escribir c√≥digo m√°s elaborado, existe mayor necesidad de pensar
como codificar las soluciones a los problemas. Una vez que se soluciona el problema,
se dedicar√° una gran cantidad de tiempo en revisar y perfeccionar el algoritmo.</simpara>
<simpara>Los comentarios te permiten escribir en lenguaje humano como Ingl√©s o Espa√±ol, dentro
de los programas.</simpara>
<simpara>Los comentarios en <emphasis>Wren</emphasis> utilizan la misma sintaxis que el <link xl:href="https://es.wikipedia.org/wiki/C_(lenguaje_de_programaci%C3%B3n)"><literal>Lenguaje de Programaci√≥n C</literal></link>.</simpara>
<simpara>Los s√≠mbolos son los siguientes: <literal>/* */</literal> (multi l√≠nea) y <literal>//</literal> (l√≠nea √∫nica).</simpara>
<programlisting language="js" linenumbering="numbered">// Comentario de una sola l√≠nea

/*
Este comentario
tiene m√∫ltiples
l√≠neas
*/</programlisting>
<simpara>Se pueden anidar los comentarios. √∫til para comentar c√≥digo que ya tenga comentarios.</simpara>
<programlisting language="js" linenumbering="numbered">/*
Este comentario
tiene m√∫ltiples
l√≠neas.
  /* Tambi√©n puedes incluir comentarios,
  dentro de comentarios multi l√≠nea.
  */
*/</programlisting>
<section xml:id="_tip_comentarios_tijera">
<title>Tip: Comentarios Tijera</title>
<simpara>Puedes combinar los comentarios de una sola l√≠nea con los de m√∫ltiples l√≠neas para
comentar/descomentar r√°pidamente secciones de c√≥digo. Se llaman comentarios tijera
por que pueden "cortar" un c√≥digo para no ser ejecutado.</simpara>
<programlisting language="js" linenumbering="numbered">// /*
  codigo()
// */</programlisting>
<simpara>Al eliminar el comentario de la primera l√≠nea, el c√≥digo ser√° comentado. De esta forma r√°pidamente
puedes activar o desactivar secciones de c√≥digo.</simpara>
<programlisting language="js" linenumbering="numbered">/*
  codigo()
// */</programlisting>
<simpara>Puede a√∫n ser m√°s simplificado de esta forma</simpara>
<programlisting language="js" linenumbering="numbered">//*
  codigo()
// */</programlisting>
<simpara>Si se elimina el primer <literal>/</literal> el c√≥digo ser√° comentado. Por lo que se ahorra un par de movimientos al realizar el comentario.</simpara>
<programlisting language="js" linenumbering="numbered">/*
  codigo()
// */</programlisting>
</section>
<section xml:id="_tip_comentarios_de_par√°metros">
<title>Tip: Comentarios de par√°metros</title>
<simpara>En <emphasis>Wren</emphasis> no es posible llamar a los par√°metros por su nombre. Por lo que si utilizas una funci√≥n
con algunos par√°metros, puede ser √∫til comentarlos.</simpara>
<programlisting language="js" linenumbering="numbered">circulo(/* x */ 10, /* y */ 20, /* radio */ 10)</programlisting>
<simpara>O mejor a√∫n utilizar variables con nombres significativos</simpara>
<programlisting language="js" linenumbering="numbered">var x = 10
var y = 20
var radio = 10
circulo(x, y, radio)</programlisting>
</section>
<section xml:id="_c√≥mo_es_un_buen_comentario">
<title>¬øC√≥mo es un buen comentario?</title>
<itemizedlist>
<listitem>
<simpara>Es completo, corto y directo. La mayor√≠a de los comentarios deber√≠an ser escritos en p√°rrafos.</simpara>
</listitem>
<listitem>
<simpara>Explica tu forma de pensar, para que cuando regreses a leer el c√≥digo en el futuro puedas comprender c√≥mo se ha resuelto el problema.</simpara>
</listitem>
<listitem>
<simpara>Tambi√©n explica pensando en otros, para que otras personas puedan trabajar en tu c√≥digo y entender c√≥mo lo haz estructurado.</simpara>
</listitem>
<listitem>
<simpara>Explica una secci√≥n dif√≠cil con mayor detalle.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_cu√°ndo_comentar">
<title>¬øCu√°ndo comentar?</title>
<itemizedlist>
<listitem>
<simpara>Cuando tienes que pensar c√≥mo funciona el c√≥digo antes de escribirlo.</simpara>
</listitem>
<listitem>
<simpara>Cuando probablemente olvides como estabas resolviendo un problema.</simpara>
</listitem>
<listitem>
<simpara>Cuando exista m√°s de una forma de resolver un problema.</simpara>
</listitem>
<listitem>
<simpara>Cuando es poco probable que otros comprendan c√≥mo haz resuelto un problema.</simpara>
</listitem>
</itemizedlist>
<simpara>Escribir buenos comentarios es un indicador de un buen programador. √ösalos siempre. Ver√°s comentarios a lo largo de los ejemplos en este documento.</simpara>
</section>
</section>
<section xml:id="_l√≠mites">
<title>L√≠mites</title>
<itemizedlist>
<listitem>
<simpara>M√°ximo de 16 par√°metros en una funci√≥n o m√©todo.</simpara>
</listitem>
<listitem>
<simpara>M√°ximo de 255 propiedades en una clase (incluyendo la herencia).</simpara>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="_strings_cadena_de_caracteres">
<title><link xl:href="http://wren.io/modules/core/string.html">Strings: Cadena de caracteres</link></title>
<simpara>Las cadenas de caracteres (<emphasis>String</emphasis>) son delimitadas por las comillas dobles (<literal>"</literal>). Pueden ser de una sola l√≠nea o multi l√≠nea. En el caso de ser multi l√≠nea, estas conservar√°n todos los caracteres de espacio y salto de l√≠nea contenidos en el <emphasis>string</emphasis>. El caracter de comilla simple (<literal>'</literal>) no es significativo para <emphasis>Wren</emphasis>.</simpara>
<simpara>Las strings pueden contener caracteres unicode en <link xl:href="http://utf8everywhere.org/">UTF-8</link>, como tambi√©n caracteres no v√°lidos para <emphasis>UTF-8</emphasis>.</simpara>
<simpara>Adem√°s son inmutables. El string <emphasis role="strong">"porotos"</emphasis> no podr√° ser modificado (cambiando sus caracteres) luego de su creaci√≥n.</simpara>
<simpara>Un string puede contener los siguientes valores:</simpara>
<itemizedlist>
<listitem>
<simpara>Una cadena de texto compuesto por una secuencia de puntos de c√≥digo textuales (textual code point).</simpara>
</listitem>
<listitem>
<simpara>Una cadena iterable compuesta por una secuencia de puntos de c√≥digo num√©rico (numeric code point).</simpara>
</listitem>
<listitem>
<simpara>Un arreglo simple de bytes indexeables.</simpara>
</listitem>
</itemizedlist>
<section xml:id="_string_de_una_l√≠nea">
<title>String de una l√≠nea</title>
<programlisting language="js" linenumbering="numbered">"Solo es necesario comillas dobles"</programlisting>
</section>
<section xml:id="_string_multi_l√≠nea">
<title>String multi l√≠nea</title>
<simpara><emphasis>Wren</emphasis> permite string multi l√≠neas utilizando el mismo caracter de comillas dobles (<literal>"</literal>) de las strings de una sola l√≠nea.</simpara>
<programlisting language="js" linenumbering="numbered">"
 Todo esto es una string multi l√≠nea
 Wren esperar√° hasta que aparezca
 la siguiente comilla doble.
 Los strings multi l√≠nea en Wren guardan tanto espacios como saltos de l√≠nea en su interior.
 (no son omitidos).
"</programlisting>
</section>
<section xml:id="_contando_el_largo_del_string">
<title>Contando el largo del string</title>
<simpara>Si utilizamos la propiedad <literal>count</literal> podremos obtener el largo de un string.</simpara>
<simpara>Por ejemplo <literal>"hola".count</literal> devolver√° <literal>4</literal>. Hay que tener cuidado con los caracteres unicode (emojis), ya que el largo depender√° de lo que se est√© contando. <emphasis>Wren</emphasis> cuenta los puntos de c√≥digo (code point) unicode, por que todos los strings est√°n bajo <emphasis>UTF-8</emphasis> (similar al comportamiento de <link xl:href="https://www.ruby-lang.org/en/"><emphasis>Ruby</emphasis></link> y <link xl:href="https://www.python.org/"><emphasis>Python 3</emphasis></link>).</simpara>
<programlisting language="js" linenumbering="numbered">System.print("a".count) // Retorna 1.
System.print("a".bytes.count) // Retorna 1 (Parte de la tabla ASCII original).

System.print("√±".count) // Retorna 1.
System.print("√±".bytes.count) // Retorna 2.

System.print("üëπ".count) // Retorna 1.
System.print("üëπ".bytes.count) // Retorna 4.

System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".count) // Retorna 7 al contar la unidades de c√≥digo de Unicode
System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".bytes.count) // Retorna 25 al contar los bytes UTF-8</programlisting>
<simpara><literal>System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".count)</literal> retorna 7 por que se est√° contando las unidades de c√≥digo de unicode, es decir, el emoji üë®‚Äçüë©‚Äçüëß‚Äçüë¶ est√° formado por los siguientes caracteres : üë® + caracter de uni√≥n de ancho cero + üë© + caracter de uni√≥n de ancho cero + üëß + caracter de uni√≥n de ancho cero + üë¶.</simpara>
<simpara><literal>System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".bytes.count)</literal> retorna 25 por que est√° contando los bytes necesarios para almacenar estos caracteres. bytes es una secuencia de caracteres en C, lo que permite utilizar los Strings para almacenar informaci√≥n en binario.</simpara>
<simpara>Hay dos formas de contar adicionales que <emphasis>Wren</emphasis> no soporta. La primera es contar por unidades de c√≥digo <emphasis>UTF-16</emphasis> y la otra es considerar los emojis compuestos como una unidad.</simpara>
<simpara>El string "üë®‚Äçüë©‚Äçüëß‚Äçüë¶" deber√≠a ser de largo 11 para la codificaci√≥n <emphasis>UTF-16</emphasis>. Mientras que deber√≠a ser de largo 1 si lo consideramos como un caracter singular (lo que percibe el usuario). Seg√∫n los amigos de <link xl:href="http://utf8everywhere.org/">UTF-8 Everywhere</link> contar de estas formas es poco productivo, ya que lo que importa es realmente los code units (unidades de c√≥digo) <emphasis>UTF-8</emphasis> que se tiene al escribir un string. Por lo que <emphasis>Wren</emphasis> tiene un comportamiento adecuado. De todas formas ese tipo de conversiones y conteo podr√≠a programarse con c√≥digos externos a <emphasis>Wren</emphasis>. M√°s detalles en el <link xl:href="https://www.unicode.org/glossary/">Glosario Unicode</link>.</simpara>
</section>
<section xml:id="_uni√≥n_e_interpolaci√≥n_de_strings">
<title>Uni√≥n e interpolaci√≥n de strings</title>
<simpara>Si deseamos unir varios strings o incluir datos dentro de ellos podemos utilizar las siguientes operaciones: <literal>+</literal> y <literal>%()</literal>.</simpara>
<itemizedlist>
<listitem>
<simpara><literal>"Hola" + "Wren"</literal>: Crea un nuevo string con la uni√≥n de <literal>Hola</literal> y <literal>Wren</literal>. Entregar√° <literal>HolaWren</literal>. Es necesario que ambos objetos sean strings. Por ejemplo si se utiliza <literal>"Hola" + 1</literal> entregar√° un error similar a <literal>Runtime error: Right operand must be a string.</literal>. Para poder unirlos tendremos que utiliza el m√©todo getter <literal>toString</literal> del n√∫mero. <literal>"Hola" + 1.toString</literal>, retornando <literal>Hola1</literal>.</simpara>
</listitem>
</itemizedlist>
<simpara>El m√©todo <literal>toString</literal> es parte de la clase <link xl:href="http://wren.io/modules/core/object.html"><literal>Object</literal></link> la cual es la padre de todos los tipos de datos en <emphasis>Wren</emphasis>. Tanto n√∫meros, booleanos, strings y listas son objetos que heredan de esta clase.</simpara>
<itemizedlist>
<listitem>
<simpara><literal>"Hola %(mundo)"</literal>: Crea un string con la frase <literal>Hola</literal> y el contenido de la variable <literal>mundo</literal>.</simpara>
</listitem>
</itemizedlist>
<simpara>La operaci√≥n <literal>%()</literal> permite incluir cualquier instrucci√≥n <emphasis>Wren</emphasis> v√°lida, la cual finalmente ejecutar√° el m√©todo <literal>toString</literal> para ser incluido en la cadena de caracteres. Esto incluso permite tener interpolaciones anidadas, pero eso se vuelve poco legible r√°pidamente.</simpara>
<programlisting language="js" linenumbering="numbered">// muestra: La respuesta es 42.
System.print("La respuesta es %(20 * 2 + 2).")

// muestra: wow 149
System.print("wow %((1..3).map {|n| n * n}.join())")</programlisting>
</section>
<section xml:id="_multiplicaci√≥n_de_strings">
<title>Multiplicaci√≥n de strings</title>
<simpara>Tambi√©n se pueden multiplicar para repetir la cadena de caracteres una cantidad de veces determinada.</simpara>
<programlisting language="js" linenumbering="numbered">// muestra hola hola hola
System.print("hola " * 3)</programlisting>
<literallayout class="monospaced">Si bien se pueden sumar (_+_) y multiplicar (_*_), no existe operaciones para resta (_-_) y division (_/_) dentro de una cadena de caracteres.</literallayout>
</section>
<section xml:id="_limitar_el_m√°ximo_de_caracteres">
<title>Limitar el m√°ximo de caracteres</title>
<simpara>El <emphasis>String</emphasis> al ser una <emphasis>Secuencia</emphasis> puede utilizar
sus m√©todos como <emphasis>take()</emphasis> que permite obtener los
elementos dentro de una secuencia. El m√©todo <emphasis>join()</emphasis>
es necesario para convertir nuevamente la secuencia
en un <emphasis>String</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">// muestra: hola
System.print("hola wren".take(4).join())</programlisting>
</section>
<section xml:id="_caracteres_no_imprimibles">
<title>Caracteres no imprimibles</title>
<simpara>Los caracteres no imprimibles o <emphasis>Whitespace</emphasis> son aquellos
caracteres que el computador puede ver, pero son invisibles
para una persona. Los caracteres no imprimibles m√°s comunes son el espacio (<emphasis>" "</emphasis>), la tabulaci√≥n (<emphasis>"\t"</emphasis>) y el salto de l√≠nea (<emphasis>"\n"</emphasis>). La combinaci√≥n de dos caracteres <emphasis>"\t"</emphasis> crea un nuevo espacio tabulado, mientras que la combinaci√≥n de dos caracteres <emphasis>"\n"</emphasis> crea una nueva l√≠nea dentro del <emphasis>String</emphasis>. ¬°Puedes usarlos cuant√°s veces y d√≥nde desees!.</simpara>
<simpara>Prueba el siguiente c√≥digo:</simpara>
<programlisting language="js" linenumbering="numbered">System.print("Hola a todos")
System.print("\tHola a todos")
System.print("Hola\na todos")
System.print("\n\n\nHola\ta\ttodos")</programlisting>
<section xml:id="_eliminando_caracteres_no_imprimibles">
<title>Eliminando caracteres no imprimibles</title>
<simpara>Muchas veces al solicitar datos a un usuario, este puede incluir espacios adicionales al principio o final. Usualmente es buena idea eliminar estos caracteres no imprimibles antes de comenzar a procesar el dato.</simpara>
<programlisting language="js" linenumbering="numbered">var nombre = " arturo "

// Elimina solamente espacio final
System.print(nombre.trimEnd())

// Elimina solamente espacio inicial
System.print(nombre.trimStart())

// Elimina espacio inicial y final
System.print(nombre.trim())</programlisting>
<simpara>Si se necesita ver con mayor claridad lo que sucede
se puede usar el siguiente c√≥digo:</simpara>
<programlisting language="js" linenumbering="numbered">var nombre = " arturo "

// Elimina solamente espacio final
System.print("-" + nombre.trimEnd() + "-")

// Elimina solamente espacio inicial
System.print("-" + nombre.trimStart() + "-")

// Elimina espacio inicial y final
System.print("-" + nombre.trim() + "-")</programlisting>
</section>
</section>
<section xml:id="_caracteres_de_escape">
<title>Caracteres de escape</title>
<simpara>Muchas veces se necesitan escribir caracteres especiales en un string. Por ejemplo si quisieramos escribir <literal>"Hola Wren"</literal> incluyendo las comillas, tendr√≠amos que escribirlo de esta forma <literal>"\"Hola Wren\""</literal>. Esto incluir√° los caracteres de comillas dobles en la frase.</simpara>
<programlisting language="js" linenumbering="numbered">"\0" // byte NUL (Nulo) : 0.
"\"" // Comillas dobles.
"\\" // Barra invertida.
"\%" // Signo porcentaje.
"\a" // Sonido de alarma.
"\b" // Retroceso.
"\f" // Alimentaci√≥n de formularios.
"\n" // Salto de l√≠nea.
"\r" // Retorno de carro.
"\t" // Tabulaci√≥n.
"\v" // Tabulaci√≥n vertical.</programlisting>
<simpara>Para indicar caracteres especiales podemos utilizar <literal>\u</literal> (unicode para letras disponibles en los idiomas humanos), <literal>\U</literal> (unicode para letras especiales como emoji) y <literal>\x</literal> (bytes sin codificar).</simpara>
<itemizedlist>
<listitem>
<simpara><literal>System.print("\u0041\u0b83\u00DE")</literal> = A‡ÆÉ√û</simpara>
</listitem>
<listitem>
<simpara><literal>System.print("\U0001F64A\U0001F680")</literal> = üôäüöÄ</simpara>
</listitem>
<listitem>
<simpara><literal>System.print("\x48\x69\x2e")</literal> = Hi.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_rangos_de_caracteres">
<title>Rangos de caracteres</title>
<simpara>Un <emphasis>String</emphasis> es una <emphasis>Secuencia</emphasis> de caracteres. Por lo que es posible obtener caracteres en posiciones espec√≠ficas
utilizando rangos (<emphasis>Range</emphasis>). El √≠ndice comieza contando
desde cero para contar desde el principio de la cadena y puede tener valores negativos para contar
desde el final de la cadena.</simpara>
<section xml:id="_caracter_en_posici√≥n_espec√≠fica">
<title>Caracter en posici√≥n espec√≠fica</title>
<programlisting language="js" linenumbering="numbered">// muestra: h
System.print("hola wren"[0])

// muestra: n
System.print("hola wren"[-1])</programlisting>
</section>
<section xml:id="_rango_de_caracteres_dentro_de_una_cadena">
<title>Rango de caracteres dentro de una cadena</title>
<programlisting language="js" linenumbering="numbered">// muestra: la
System.print("hola wren"[2..3])</programlisting>
</section>
<section xml:id="_invertir_una_cadena_de_caracteres">
<title>Invertir una cadena de caracteres</title>
<programlisting language="js" linenumbering="numbered">// muestra: nerw aloh
System.print("hola wren"[-1..0])</programlisting>
</section>
</section>
<section xml:id="_ejercicios_2">
<title>Ejercicios</title>
<section xml:id="chap3-ex1">
<title>Donas</title>
<simpara>Dada una cantidad de un n√∫mero de donas,
retornar un string con el contenido
<emphasis>"N√∫mero de donas: &lt;cantidad&gt;"</emphasis>. Si
la cantidad es mayor o igual a 10, usar
la palabras <emphasis>'muchas'</emphasis> en vez del n√∫mero de cantidad.</simpara>
<simpara>Ejercicio basado en <xref linkend="googlepython"/>.</simpara>
<formalpara>
<title>Ejecuci√≥n</title>
<para><literal>$ ./wren donas.wren</literal></para>
</formalpara>
<itemizedlist>
<title>Ejemplo</title>
<listitem>
<simpara><literal>donas.call(5)</literal> retorna <emphasis>"N√∫mero de donas: 5"</emphasis></simpara>
</listitem>
<listitem>
<simpara><literal>donas.call(23)</literal> retorna <emphasis>"N√∫mero de donas: muchas"</emphasis></simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>C√≥digo</title>
<para>
<programlisting language="js" linenumbering="numbered">var donas = Fn.new {|cantidad|
  // Tu c√≥digo aqu√≠
}


// Pruebas para evaluar que el ejercicio
// se ha completado exitosamente.
// no modificar.

var probar = Fn.new {|tengo, quiero|
  var prefijo = " X "
  if (tengo == quiero) {
    prefijo = " OK "
  }
  System.print("%(prefijo) tengo: %(tengo) quiero: %(quiero)")
}

System.print("Probando donas")
probar.call(donas.call(4), "N√∫mero de donas: 4")
probar.call(donas.call(9), "N√∫mero de donas: 9")
probar.call(donas.call(10), "N√∫mero de donas: muchas")
probar.call(donas.call(99), "N√∫mero de donas: muchas")
System.print()</programlisting>
</para>
</formalpara>
<formalpara>
<title>Soluci√≥n</title>
<para><xref linkend="chap3-ex1-sol"/></para>
</formalpara>
</section>
</section>
</chapter>
<chapter xml:id="_num_n√∫meros">
<title><link xl:href="https://wren.io/modules/core/num.html">Num: N√∫meros</link></title>
<simpara>Los datos num√©ricos son bastante conocidos, sin embargo hay algunas cosas que se deben tener en cuenta. Como la mayor√≠a de los lenguajes interpretados, <emphasis>Wren</emphasis> tiene un √∫nico tipo num√©rico: punto flotante de doble precisi√≥n. Los n√∫meros en <emphasis>Wren</emphasis> son similares a otros lenguajes y son instancias de la clase <emphasis>Num</emphasis>.</simpara>
<simpara>Los siguientes son algunos ejemplos:</simpara>
<programlisting language="js" linenumbering="numbered">// Enteros
0
1234
-5678

// Decimales
3.14159
1.0
-12.34

// Notaci√≥n cient√≠fica
0.0314159e02
314.159e-02</programlisting>
<section xml:id="_enteros">
<title>Enteros</title>
<simpara>Se pueden realizar todas las operaciones tradicionales con n√∫meros enteros. Suma (<emphasis>+</emphasis>), resta (<emphasis>-</emphasis>), multiplicaci√≥n (<emphasis>*</emphasis>), divisi√≥n (<emphasis>/</emphasis>) y m√≥dulo (<emphasis>%</emphasis>). Para utilizar exponentes se debe usar el m√©todo <emphasis>pow()</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">System.print(3+2)

System.print(3-2)

System.print(3*2)

System.print(3/2)

System.print(3%2)

System.print(3.pow(2))</programlisting>
<simpara>Tambi√©n se puede utilizar par√©ntesis para alterar el orden de las operaciones.</simpara>
<programlisting language="js" linenumbering="numbered">var ordenNormal = 2+3*4

System.print(ordenNormal)

var ordenMio = (2+3)*4

System.print(ordenMio)</programlisting>
</section>
<section xml:id="_punto_flotante">
<title><link xl:href="https://github.com/Pybonacci/puntoflotante.org">Punto Flotante</link></title>
<simpara>Los n√∫meros de punto flotante se refieren a cualquier n√∫mero con una parte decimal. La mayor√≠a del tiempo se comportan de una forma matem√°tica tradicional. Pero en muchas ocaciones se obtienen resultados con una parte decimal m√°s larga de lo esperado. Esto ocurre por como las computadoras representan los n√∫meros internamente; no tiene que ver con <emphasis>Wren</emphasis> mismo. B√°sicamente, los humanos est√°n acostumbrados a trabajar con n√∫meros <emphasis>base 10</emphasis>, donde <emphasis>0.1</emphasis> + <emphasis>0.2</emphasis> = <emphasis>0.3</emphasis>. Pero las computadoras trabajan en <emphasis>base 2</emphasis> y expresan los resultados como una potencia de dos. No existe una representaci√≥n exacta para <emphasis>0.3</emphasis> en una potencia de dos y por esa raz√≥n el resultado presenta tantos decimales.</simpara>
<simpara>Como la memoria de las computadoras es limitada, no pueden almacenar n√∫meros
con precisi√≥n infinita, en alg√∫n momento se debe limitar. Pero ¬øCu√°nta precisi√≥n se necesita?
¬øY <emphasis>d√≥nde</emphasis> se necesita?, ¬øCu√°ntos d√≠gitos enteros y cu√°ntos fraccionarios?</simpara>
<itemizedlist>
<listitem>
<simpara>Para un ingeniero construyendo una autopista, no importa si tiene 10 metros o 10.0001 metros de ancho ‚îÄ posiblemente ni siquiera sus mediciones eran as√≠ de precisas.</simpara>
</listitem>
<listitem>
<simpara>Para alguien dise√±ando un microchip, 0.0001 metros (la d√©cima parte de un mil√≠metro) es una diferencia <emphasis>enorme</emphasis> ‚îÄ pero nunca tendr√° que manejar distancias mayores de 0.1 metros.</simpara>
</listitem>
<listitem>
<simpara>Un f√≠sico necesita usar la <link xl:href="http://es.wikipedia.org/wiki/Velocidad_de_la_luz">velocidad de la luz</link> (m√°s o menos 300000000) y la <link xl:href="http://es.wikipedia.org/wiki/Constante_de_gravitaci%C3%B3n_universal">constante de gravitaci√≥n universal</link> (m√°s o menos 0.0000000000667) juntas en el mismo c√°lculo.</simpara>
</listitem>
</itemizedlist>
<simpara>Para satisfacer al ingeniero y al dise√±ador de circuitos integrados, el formato
tiene que ser preciso para n√∫meros de √≥rdenes de magnitud muy diferentes. Sin
embargo, solo se necesita precisi√≥n <emphasis>relativa</emphasis>. Para satisfacer al f√≠sico, debe
ser posible hacer c√°lculos que involucren n√∫meros de √≥rdenes muy dispares.</simpara>
<simpara>B√°sicamente, tener un n√∫mero fijo de d√≠gitos enteros y fraccionarios no es √∫til ‚îÄ y la soluci√≥n es un formato con un <emphasis>punto flotante</emphasis>.</simpara>
<section xml:id="_comparaci√≥n_de_punto_flotante">
<title>Comparaci√≥n de Punto Flotante</title>
<simpara>Si realizamos una peque√±a comparaci√≥n de n√∫meros con punto flotante, nos encontraremos con que algunas comparaciones simples no pueden ser realizadas correctamente de la forma tradicional.</simpara>
<simpara>Debido a los errores de redondeo, la mayor√≠a de los n√∫meros de punto flotante terminan siendo ligeramente imprecisos. Mientras esta imprecisi√≥n se mantenga peque√±a, normalmente se puede ignorar. Sin embargo, esto significa tambi√©n que n√∫meros que se espera que sean iguales (por ejemplo al calcular el mismo resultado utilizando distintos m√©todos correctos) a veces difieren levemente, y una simple prueba de igualdad falla:</simpara>
<programlisting language="js" linenumbering="numbered">var a = 0.15 + 0.15
var b = 0.1 + 0.2

// puede ser falso
if (a == b) {}

// tambi√©n puede ser falso
if (a &gt;= b) {}</programlisting>
<simpara>Como los n√∫meros de punto flotante tienen una cantidad de d√≠gitos limitados, no pueden representar todos los <link xl:href="http://es.wikipedia.org/wiki/N%C3%BAmero_real">n√∫meros reales</link> de forma precisa: cuando hay m√°s d√≠gitos de los que permite el formato, los que sobran se omiten.</simpara>
<simpara>La soluci√≥n es comprobar no si los n√∫meros son exactamente iguales, sino si su <emphasis>diferencia es muy peque√±a</emphasis>. El margen de error frente al que se compara esta diferencia normalmente se llama <emphasis>epsilon</emphasis>.</simpara>
<simpara>El valor de <emphasis>epsilon</emphasis> depender√° del contexto. Nunca usar un <emphasis>epsilon</emphasis> fijo. Un <emphasis>epsilon</emphasis> fijo elegido porque ¬´parece peque√±o¬ª podr√≠a perfectamente ser demasiado grande cuando los n√∫meros que se comparan son tambi√©n muy peque√±os. La comparaci√≥n devolver√≠a ¬´verdadero¬ª para n√∫meros muy diferentes. Y cuando los n√∫meros son muy grandes, el <emphasis>epsilon</emphasis> puede acabar siendo m√°s peque√±o que el m√≠nimo error de redondeo, por lo que la comparaci√≥n siempre devolver√≠a ¬´falso¬ª. Por tanto, es necesario ver si el error relativo es menor que <emphasis>epsilon</emphasis>.</simpara>
<simpara>El c√≥digo a continuaci√≥n pasa las pruebas para muchos casos especiales importantes, pero como puedes ver, utiliza cierta l√≥gica no trivial. En particular, tiene que utilizar una definici√≥n totalmente distinta del margen de error cuando a o b son cero, porque la definici√≥n cl√°sica del error relativo es in√∫til en esos casos.</simpara>
<simpara>Hay algunos casos en los que todav√≠a produce resultados inesperados (concretamente, es mucho m√°s estricto cuando un valor es casi cero que cuando es exactamente cero), y algunas de esas pruebas para las que fue desarrollado probablemente especifica un comportamiento que no es apropiado para algunas aplicaciones. Antes de usarlo, ¬°aseg√∫rate de que es adecuado para tu aplicaci√≥n!.</simpara>
<programlisting language="js" linenumbering="numbered">var equivalentes = Fn.new { |a, b, epsilon|

  var absA = a.abs
  var absB = b.abs
  var diff = (a - b).abs

  // Atajo, maneja los infinitos
  if (a == b) {
      return true
  }

  // a o b o ambos son cero
  if (a * b == 0) {
      // El error relativo no es importante aqu√≠.
      // Se tiene que utilizar una definici√≥n totalmente distinta
      // del margen de error cuando a o b son cero, porque la definici√≥n
      // cl√°sica del error relativo es in√∫til en esos casos.
      return diff &lt; (epsilon * epsilon)
  }

  // Usar el error relativo
  return diff / (absA + absB) &lt; epsilon
}

// Prueba de la funci√≥n
var a = 0.15 + 0.15
var b = 0.1 + 0.2

// Epsilon siempre debe ser entregado seg√∫n el contexto de comparaci√≥n
// no utilizar epsilon fijos.
var epsilon = 0.001

var eq = equivalentes.call(a, b, epsilon)

// Deber√≠a ser verdadero
System.print(eq)</programlisting>
</section>
</section>
<section xml:id="_formateo_de_punto_flotante">
<title>Formateo de Punto Flotante</title>
<simpara>En muchas ocaciones se necesita limitar la cantidad
de decimales que un n√∫mero muestra. <emphasis>Wren</emphasis> no cuenta
con instrucciones para formatear n√∫meros como <emphasis>C</emphasis> u otros lenguajes (Ejemplo: <link xl:href="http://www.cplusplus.com/reference/cstdio/printf/"><emphasis>"%1.2f"</emphasis></link>.)</simpara>
<simpara>Sin embargo existen algunas alternativas.</simpara>
<simpara>Tomemos por ejemplo la constante <emphasis>PI</emphasis> (<literal>Num.pi</literal>) =~ <emphasis>3.141592</emphasis>.</simpara>
<simpara>Si solamente quisieramos mostrar la parte entera (<emphasis>3</emphasis>) podemos utilizar el m√©todo <emphasis>truncate</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">// Solamente muestra 3
System.print(Num.pi.truncate)</programlisting>
<simpara>Si desearamos mostrar <emphasis>3.14</emphasis> podemos usar la siguiente f√≥rmula.</simpara>
<simpara><literal>(numero * 1e&lt;posiciones decimales&gt;).truncate / 1e&lt;posiciones decimales&gt;</literal></simpara>
<programlisting language="js" linenumbering="numbered">var formateado = (Num.pi * 1e2).truncate / 1e2

// Muestra 3.14
System.print(formateado)</programlisting>
<simpara>Podemos crear una funci√≥n que generalice esta f√≥rmula a cualquier cantidad de decimales.</simpara>
<programlisting language="js" linenumbering="numbered">var formatear = Fn.new {|numero, decimales| (numero * 10.pow(decimales)).truncate / 10.pow(decimales)}

// Muestra 3.14
System.print(formatear.call(Num.pi, 2))</programlisting>
<simpara>El problema de esta soluci√≥n es que existe la posibilidad de perder precisi√≥n en los decimales, lo que puede causar problemas de c√°lculo. Para evitar este problema la soluci√≥n recomendable es transformar el n√∫mero a <emphasis>String</emphasis> y obtener los decimales por medio de manipulaci√≥n de <emphasis>strings</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">// Convertimos el n√∫mero a String
var string = Num.pi.toString

// Queremos mostrar 3.14
var posiciones = 2

// Buscamos donde comienzan los decimales
var index = string.indexOf(".")

// Separamos el n√∫mero entre entero y decimal
var entero = string[0...index]
var decimal = string[index + 1..-1]

// Obtenemos los decimales a mostrar
var decimales = decimal.take(posiciones).join()

// Reunimos la parte entera y decimal
var formateado = entero + "." + decimales

System.print(formateado)</programlisting>
</section>
</chapter>
<chapter xml:id="_secuencias_listas_y_rangos">
<title>Secuencias, Listas y Rangos</title>
<section xml:id="_sequence">
<title><link xl:href="https://wren.io/modules/core/sequence.html">Sequence</link></title>
<simpara>La secuencia es la clase padre de <emphasis>List</emphasis>, <emphasis>String</emphasis>, <emphasis>Map</emphasis>, <emphasis>Range</emphasis> y cualquier otra que implemente el <link xl:href="https://wren.io/control-flow.html#the-iterator-protocol"><emphasis>protocolo de iteraci√≥n</emphasis></link>. La caracter√≠stica principal de una secuencia es que esta podr√≠a ser virtualmente infinita (sin elementos que indiquen un fin).
Entre los m√©todos que podemos destacar de <emphasis>Sequence</emphasis> est√°n:</simpara>
<section xml:id="_each">
<title>each</title>
<simpara>Similar a un bucle <literal>for</literal>. Por cada elemento dentro de la secuencia llama a una funci√≥n cuyo par√°metro es el siguiente elemento en la secuencia.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]
numeros.each {|num|
  System.print(num)
}</programlisting>
</section>
<section xml:id="_map">
<title>map</title>
<simpara>Llama a una funci√≥n cuyo par√°metro es el siguiente elemento en la secuencia. Retorna una nueva secuencia con el resultado de las operaci√≥n en cada elemento.
El resultado de <literal>map</literal> es almacenado por referencia. Lo que significa que cambios posteriores en la secuencia original pueden afectar el valor del resultado de <literal>map</literal>.
Para pasarlo a una variable independiente, se debe ejecutar el m√©todo <literal>toList</literal>.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]

// .toList es necesario para que System.print() muestre la lista apropiadamente.
// Esto es debido a que una secuencia puede no tener fin. Necesitamos pasarlo a una estructura de datos finita.
// Tambi√©n estamos utilizando el "retorno impl√≠cito".
numeros = numeros.map{|num| num + 1}.toList

// Muestra [2, 3, 4]
System.print(numeros)</programlisting>
</section>
<section xml:id="_where">
<title>where</title>
<simpara>Filtra una secuencia. Entregar√° una nueva lista la cual cumpla la condicional. Al igual que <literal>map</literal> se debe ejecutar el m√©todo <literal>toList</literal> para evitar que modificaciones en la secuencia original afecten la nueva secuencia.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3, 4]

var pares = numeros.where{|num| num % 2 == 0}.toList

// Muestra [2, 4]
System.print(pares)</programlisting>
</section>
<section xml:id="_reduce">
<title>reduce</title>
<simpara>Llama a una funci√≥n cuyo par√°metro es el siguiente elemento en al secuencia. Retorna un √∫nico elemento, producto de las operaciones en cada elemento.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]

// Si no se pasa un acumulador, se considera el primer elemento como valor inicial
var resultado = numeros.reduce {|acumulador, num| acumulador + num}

// Muestra 6
System.print(resultado)

// Iniciamos el acumulador con valor -1
resultado = numeros.reduce(-1) {|acumulador, num| acumulador + num}

// Muestra 5
System.print(resultado)</programlisting>
</section>
<section xml:id="_take">
<title>take</title>
<simpara>Obtiene un n√∫mero de elementos dentro de una secuencia.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3, 4]
var primeros = numeros.take(2).toList

// Muestra [1, 2]
System.print(primeros)</programlisting>
</section>
<section xml:id="_skip">
<title>skip</title>
<simpara>La operaci√≥n inversa de <literal>take</literal>. Salta un n√∫mero determinado de elementos.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3, 4]
var ultimos = numeros.skip(2).toList

// Muestra [3, 4]
System.print(ultimos)</programlisting>
</section>
<section xml:id="_contains">
<title>contains</title>
<simpara>Retorna verdadero si la secuencia contiene al elemento.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]

// Muestra "false" debido a que no contiene el n√∫mero 4
System.print(numeros.contains(4))</programlisting>
</section>
<section xml:id="_count">
<title>count</title>
<simpara>Retorna el n√∫mero de elementos de la secuencia. Tambi√©n es posible solamente contar elementos que cumplan una condici√≥n.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3, 4]

// 4
System.print(numeros.count)

// Contamos solamente los n√∫meros m√∫ltiplos de 2
var pares = numeros.count {|num| num % 2 == 0}

// 2
System.print(pares)</programlisting>
</section>
<section xml:id="_join">
<title>join</title>
<simpara>Une a los elementos de una secuencia transform√°ndolos en un <emphasis>String</emphasis>. Si no se pasa un par√°metro se asume un caracter vaci√≥ como uni√≥n.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]

// Muestra "123"
System.print(numeros.join())

// Muestra "1$2$3"
System.print(numeros.join("$"))

// Muestra "1 num 2 num 3"
System.print(numeros.join(" num "))</programlisting>
</section>
<section xml:id="_all">
<title>all</title>
<simpara>Itera sobre los elementos de una secuencia con una condicional. Devuelve verdadero si todos los elementos pasan la condici√≥n.
Si alguno de los elementos es falso, termina de iterar y devuelve falso.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]
var resultado = numeros.all {|num| num &gt; 2}

// Falso. No todos los n√∫meros en la secuencia son mayores a 2
System.print(resultado)

resultado = numeros.all{|num| num &lt; 4}

// Verdadero. Todos los n√∫meros en la secuencia son menores a 4
System.print(resultado)</programlisting>
</section>
<section xml:id="_any">
<title>any</title>
<simpara>Similar a <literal>all</literal>. Devuelve verdadero al primer elemento que pase la condici√≥n. Si ninguno de los elementos pasa la condici√≥n, devuelve falso.</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]
var resultado = numeros.any {|num| num % 2 == 0}

// Verdadero. Existe un n√∫mero m√∫ltiplo de 2.
System.print(resultado)

resultado = numeros.any {|num| num % 5 == 0}

// Falso. Ning√∫n n√∫mero es m√∫ltiplo de 5.
System.print(resultado)</programlisting>
</section>
</section>
<section xml:id="_list">
<title><link xl:href="https://wren.io/modules/core/list.html">List</link></title>
<simpara>Una lista es una colecci√≥n de elementos que son almacenados en una variable. Los elementos pueden estar relacionados de cierta forma o no tener ning√∫n tipo de relaci√≥n.</simpara>
<simpara>El siguiente ejemplo muestra como iterar una lista:</simpara>
<programlisting language="js" linenumbering="numbered">var estudiantes = ["Pedro", "Javier", "Nicol√°s"]

for (estudiante in estudiantes) {
    System.print("¬°Hola, " + estudiante + "!")
}

// La misma operaci√≥n anterior, pero utilizando la funci√≥n each
estudiantes.each{|estudiante|
  System.print("¬°Hola, " + estudiante + "!")
}

// A√±adimos un nuevo estudiante
estudiantes.add("Juan")

// Muestra ["Pedro", "Javier", "Nicol√°s", "Juan"]
System.print(estudiantes)

// Muestra "false" por que no existe el estudiante Mar√≠a
System.print(estudiantes.contains("Mar√≠a"))

// Muestra ["Pedro", "Javier"]
System.print(estudiantes.take(2).toList)

// Muestra "2"
System.print(estudiantes.indexOf("Javier"))</programlisting>
<programlisting language="js" linenumbering="numbered">// Generamos una lista de 4 elementos con valor 1
var elementos = [1] * 4

// Muestra [1, 1, 1, 1]
System.print(elementos)</programlisting>
<simpara>Tambi√©n podemos combinar listas f√°cilmente</simpara>
<programlisting language="js" linenumbering="numbered">var numeros = [1, 2, 3]
var letras = ["a", "b", "c"]
var elementos = numeros + letras

// Muestra [1, 2, 3, a, b, c]
System.print(elementos)</programlisting>
</section>
<section xml:id="_range">
<title><link xl:href="https://wren.io/modules/core/range.html">Range</link></title>
<simpara>Un rango es un objeto que representa una lista finita, incremental e iterable de n√∫meros.
Es una operaci√≥n disponible en cada instancia de un n√∫mero.
Es dada por la operaci√≥n <literal>..</literal> y la operaci√≥n <literal>&#8230;&#8203;</literal>.</simpara>
<itemizedlist>
<listitem>
<simpara><literal>inicio..fin</literal>: Incluye al n√∫mero <literal>fin</literal>. Ejemplo: <literal>1..3</literal> retorna <literal>[1, 2, 3]</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>inicio&#8230;&#8203;fin</literal>: No incluye al n√∫mero <literal>fin</literal>. Ejemplo <literal>1&#8230;&#8203;3</literal> retorna <literal>[1, 2]</literal>.</simpara>
</listitem>
</itemizedlist>
<programlisting language="js" linenumbering="numbered">// Mostramos los n√∫meros del 1 al 5
(1..5).each {|num|
  System.print("N√∫mero %(num)")
}</programlisting>
<programlisting language="js" linenumbering="numbered">// Mostramos del 3 al 1
((1 + 2)..(3 - 2)).each {|num|
  System.print("N√∫mero %(num)")
}</programlisting>
<programlisting language="js" linenumbering="numbered">// Mostramos del 1 al 3 utilizando bucle for.
for (num in 1..3) {
  System.print("N√∫mero %(num)")
}</programlisting>
<simpara>Los rangos son muy √∫tiles para obtener subconjuntos dentro de objetos iterables
como <emphasis>Strings</emphasis> y <emphasis>Lists</emphasis>.</simpara>
<programlisting language="js" linenumbering="numbered">var nombre = "Juanito"

// Muestra "nito"
System.print(nombre[3..-1])

// Muestra "otinauJ"
System.print(nombre[-1..0])</programlisting>
<programlisting language="js" linenumbering="numbered">var letras = ["a", "b", "c", "d", "e"]
var subconjunto = letras[1..3]

// Muestra [b, c, d]
System.print(subconjunto)</programlisting>
</section>
</chapter>
<chapter xml:id="_funciones_y_fibras">
<title>Funciones y Fibras</title>

</chapter>
<chapter xml:id="_control_de_flujo_2">
<title>Control de Flujo</title>

</chapter>
<chapter xml:id="_mapas">
<title>Mapas</title>

</chapter>
<chapter xml:id="_clases">
<title>Clases</title>

</chapter>
<chapter xml:id="_terminal_de_comandos">
<title>Terminal de Comandos</title>

</chapter>
<chapter xml:id="_proyectos_de_ejemplo_en_wren">
<title>Proyectos de ejemplo en Wren</title>
<simpara>Una colecci√≥n de c√≥digo fuente <emphasis>Wren</emphasis> con juegos y aplicaciones simples.
Se recomienda utilizar un editor de c√≥digo como <link xl:href="https://vscodium.com/">VS Codium</link>
para escribir los ejemplos.</simpara>
<simpara>Cada ejemplo puede ser categorizado en los siguientes niveles:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Niveles</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Nivel</simpara></entry>
<entry align="left" valign="top"><simpara>Descripci√≥n</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Novato</simpara></entry>
<entry align="left" valign="top"><simpara>Utiliza operaciones simples como suma, resta, multiplicaci√≥n, divisi√≥n, <emphasis>System.print()</emphasis> y estructuras de control.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Intermedio</simpara></entry>
<entry align="left" valign="top"><simpara>Utiliza funciones, diccionarios y clases simples.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Avanzado</simpara></entry>
<entry align="left" valign="top"><simpara>Utiliza clases, herencia y algoritmos avanzados.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<section xml:id="_terminal">
<title>Terminal</title>
<simpara>Aplicaciones que no necesitan interfaz gr√°fica para funcionar, solamente necesitando <emphasis>Wren CLI</emphasis> y la entrada/salida est√°ndar.</simpara>
<simpara>Basados principalmente en los c√≥digos diponibles en <link xl:href="https://github.com/asweigart/PythonStdioGames">Python Stdio Games</link> y <link xl:href="https://github.com/asweigart/inventwithpython3rded">Invent With Python</link>.</simpara>
<section xml:id="_c√≥mo_ejecutarlos">
<title>¬øC√≥mo ejecutarlos?</title>
<simpara>Primero se necesita el <link xl:href="https://github.com/wren-lang/wren-cli/releases/latest">int√©rprete de Wren</link>.</simpara>
<simpara>Para mayor documentaci√≥n sobre la consola y el lenguaje <emphasis>Wren</emphasis> se puede visitar <link xl:href="http://wren.io/cli">http://wren.io/cli</link></simpara>
</section>
<section xml:id="_adivina_el_n√∫mero">
<title>Adivina el N√∫mero</title>
<simpara>Basado en <link xl:href="http://inventwithpython.com/es/4.html">Adivina del N√∫mero</link>.</simpara>
<simpara>En el juego <emphasis>"Adivina el N√∫mero"</emphasis>. La computadora pensar√° un n√∫mero aleatorio entre 1 y 20, y te pedir√° que intentes adivinarlo. La computadora te dir√° si cada intento es muy alto o muy bajo. T√∫ ganas si adivinas el n√∫mero en seis intentos o menos.</simpara>
<simpara>Este es un buen juego para codificar ya que usa n√∫meros aleatorios y bucles, y recibe entradas del usuario en un programa corto. Aprender√°s c√≥mo convertir valores a diferentes tipos de datos, y por qu√© es necesario hacer esto. Dado que este programa es un juego, nos referiremos al usuario como el jugador. Pero llamarlo ‚Äúusuario‚Äù tambi√©n ser√≠a correcto.</simpara>
<formalpara>
<title>Nivel</title>
<para>Novato</para>
</formalpara>
<section xml:id="_ejemplo_de_ejecuci√≥n">
<title>Ejemplo de Ejecuci√≥n</title>
<simpara><literal>$ ./wren adivina/adivina.wren</literal></simpara>
<programlisting language="sh" linenumbering="numbered">¬°Hola! ¬øC√≥mo te llamas?

Alberto

Bueno, Alberto, estoy pensando en un n√∫mero entre 1 y 20.

Intenta adivinar 1/6.

10

Tu estimaci√≥n es muy alta.

Intenta adivinar 2/6.

2

Tu estimaci√≥n es muy baja.

Intenta adivinar 3/6.

4

¬°Buen trabajo, Alberto! ¬°Has adivinado mi n√∫mero en 3 intentos!</programlisting>
</section>
<section xml:id="_c√≥digo_fuente">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">// nombre: adivina.wren
// autor: Camilo Castro &lt;camilo@ninjas.cl&gt;
// original: https://github.com/asweigart/inventwithpython3rded/blob/master/translations/es/src/adivinaElN%C3%BAmero.py
// ejecutar: wren adivina/adivina.wren

import "random" for Random
import "io" for Stdin

var random = Random.new()

var intentos = 0
var maxIntentos = 6

System.print("¬°Hola!, ¬øC√≥mo te llamas?")

var nombre = Stdin.readLine()
System.print("Bueno, %(nombre), estoy pensando en un n√∫mero entre 1 y 20.")

// Un n√∫mero aleatorio entre 1 y 20.
// se necesita usar 21 debido a que el generador
// no incluye el √∫ltimo n√∫mero.
var numero = random.int(1, 21)
var estimacion = -1

while (intentos &lt; maxIntentos) {
    intentos = intentos + 1
    System.print("Intenta adivinar %(intentos)/%(maxIntentos)")
    
    estimacion = Num.fromString(Stdin.readLine())

    if (estimacion is Null) {
        System.print("Solo admito n√∫meros")
    } else if (estimacion &lt; numero) {
        System.print("Tu estimaci√≥n es muy baja")
    } else if (estimacion &gt; numero) {
        System.print("Tu estimaci√≥n es muy alta")
    } else {
        break
    }
}

if (estimacion == numero) {
    System.print("¬°Buen trabajo, %(nombre)! ¬°Haz adivinado mi n√∫mero en %(intentos) intentos!.")
}

if (estimacion != numero) {
    System.print("Pues no. El n√∫mero que estaba pensando era %(numero)")
}</programlisting>
</section>
</section>
<section xml:id="_reino_de_dragones">
<title>Reino de Dragones</title>
<simpara>Basado en <link xl:href="http://inventwithpython.com/es/6.html">Reino de Dragones</link>.</simpara>
<simpara>El juego se llama <emphasis>"Reino de Dragones"</emphasis>, y permite al jugador elegir entre dos cuevas, en una de las cuales encontrar√° un tesoro y en la otra su perdici√≥n.</simpara>
<formalpara>
<title>Nivel</title>
<para>Novato</para>
</formalpara>
<section xml:id="_c√≥mo_jugar_a_reino_de_dragones">
<title>¬øC√≥mo Jugar a Reino de Dragones?</title>
<simpara>En este juego, el jugador est√° en una tierra llena de dragones. Todos los dragones viven en cuevas junto a sus grandes montones de tesoros encontrados. Algunos dragones son amigables, y compartir√°n sus tesoros contigo. Otros son codiciosos y hambrientos, y se comer√°n a cualquiera que entre a su cueva. El jugador se encuentra frente a dos cuevas, una con un drag√≥n amigable y la otra con un drag√≥n hambriento. El jugador tiene que elegir entre las dos.</simpara>
</section>
<section xml:id="_ejemplo_de_ejecuci√≥n_2">
<title>Ejemplo de Ejecuci√≥n</title>
<simpara><literal>$ ./wren dragon/dragon.wren</literal></simpara>
<programlisting language="sh" linenumbering="numbered">Est√°s en una tierra llena de dragones. Frente a t√≠
hay dos cuevas. En una de ellas, el drag√≥n es generoso y amigable y compartir√° su tesoro contigo. El otro drag√≥n
es codicioso y est√° hambriento, y te devorar√° inmediatamente.

¬øA qu√© cueva quieres entrar? (1 √≥ 2)
1

Te aproximas a la cueva...
Es oscura y espeluznante...
¬°Un gran dragon aparece s√∫bitamente frente a t√≠! Abre sus fauces y...

¬°Te engulle de un bocado!

¬øQuieres jugar de nuevo? (s√≠ or no)

no</programlisting>
</section>
<section xml:id="_c√≥digo_fuente_2">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">// nombre: dragon.wren
// autor: Camilo Castro &lt;camilo@ninjas.cl&gt;
// original: https://github.com/asweigart/inventwithpython3rded/blob/master/translations/es/src/drag%C3%B3n.py
// ejecutar: wren dragon/dragon.wren

import "random" for Random
import "timer" for Timer
import "io" for Stdin

var random = Random.new()

var mostrarIntroduccion = Fn.new {
  System.print("Est√°s en una tierra llena de dragones. Frente a t√≠")
  System.print("hay dos cuevas. En una de ellas, el drag√≥n es generoso y")
  System.print("amigable y compartir√° su tesoro contigo. El otro drag√≥n")
  System.print("es codicioso y est√° hambriento, y te devorar√° inmediatamente.")
  System.print()
  }

  var elegirCueva = Fn.new {
  var cueva = null
  var primerDragon = "1"
  var segundoDragon = "2"

  while (cueva != primerDragon &amp;&amp; cueva != segundoDragon) {
    System.print("¬øA qu√© cueva quieres entrar? (1 √≥ 2)")
    cueva = Stdin.readLine()
  }
  return cueva
}

var explorarCueva = Fn.new { |cueva|
    // existen 1000 millisegundos en un segundo
    // por lo que para obtener 2 segundos
    // debemos multiplicar 2 * 1000
    var dosSegundos = 2 * 1000

    System.print("Te aproximas a la cueva...")
    Timer.sleep(dosSegundos)
    
    System.print("Es oscura y espeluznante...")
    Timer.sleep(dosSegundos)
    
    System.print("¬°Un gran dragon aparece s√∫bitamente frente a t√≠! Abre sus fauces y...")
    System.print()
    Timer.sleep(dosSegundos)

    // Un n√∫mero aleatorio entre 1 y 2.
    // se necesita usar 3 debido a que el generador
    // no incluye el √∫ltimo n√∫mero
    var cuevaAmigable = random.int(1, 3).toString

    if (cueva == cuevaAmigable) {
      System.print("¬°Te regala su tesoro!")
    } else {
      System.print("¬°Te engulle de un bocado!")
    }

    System.print()
}

var jugarDeNuevo = "s√≠"
while (jugarDeNuevo == "s√≠" || jugarDeNuevo == "si" || jugarDeNuevo == "s") {
  mostrarIntroduccion.call()
  var cueva = elegirCueva.call()
  explorarCueva.call(cueva)

  System.print("¬øQuieres jugar de nuevo? (s√≠ o no)")
  jugarDeNuevo = Stdin.readLine()
}

System.print("¬°Eso fue divertido, nos vemos luego!")</programlisting>
</section>
</section>
<section xml:id="_diamantes">
<title>Diamantes</title>
<simpara>Esta es una simple aplicaci√≥n creativa que muestra
diamantes de distintos tama√±os.
Basado en <link xl:href="https://github.com/asweigart/PythonStdioGames/blob/main/src/gamesbyexample/diamonds.py">Diamonds</link>.</simpara>
<formalpara>
<title>Nivel</title>
<para>Novato</para>
</formalpara>
<section xml:id="_ejemplo_de_ejecuci√≥n_3">
<title>Ejemplo de Ejecuci√≥n</title>
<simpara><literal>./wren diamantes/diamantes.wren</literal></simpara>
<programlisting language="sh" linenumbering="numbered">/\
\/

/\
\/

 /\
/  \
\  /
 \/
...</programlisting>
</section>
<section xml:id="_c√≥digo_fuente_3">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">/*
Diamantes, por Al Sweigart &lt;al@inventwithpython.com&gt;
https://github.com/asweigart/PythonStdioGames/blob/main/src/gamesbyexample/diamonds.py
Dibuja diamantes de varios tama√±os.
Adaptado a Wren por Camilo Castro &lt;camilo@ninjas.cl&gt;
https://github.com/NinjasCL/wren-libro/blob/main/juegos/diamantes/diamantes.wren
- Tags: tiny, beginner, artistic, peque√±o, novato, artistico
- Version: 1.0.0
*/

var mostrarDiamanteLineal = Fn.new { |dimension|
  // Mostrar la parte superior del diamante
  for (i in 0...dimension) {
    // Espacio izquierdo
    System.write(" " * (dimension - i - 1))
    // Parte izquierda del diamante
    System.write("/")
    // Espacio interior del diamante
    System.write(" " * (i * 2))
    // Parte derecha del diamante
    System.print("\\")
  }

  // Mostrar la parte inferior del diamante
  for (i in 0...dimension) {
    // Espacio izquierdo
    System.write(" " * i)
    // Lado izquierdo
    System.write("\\")
    // Espacio interior
    System.write(" " * ((dimension - i - 1) * 2))
    // Lado derecho
    System.print("/")
  }
}

var mostrarDiamanteRelleno = Fn.new { |dimension|
  // Mostrar la cara superior del diamante
  for (i in 0...dimension) {
    // Espaciado izquierdo
    System.write(" " * (dimension - i - 1))
    // Lado izquierdo
    System.write("/" * (i + 1))
    // Lado derecho
    System.print("\\" * (i + 1))
  }

  // Mostrar la cara inferior del diamante
  for (i in 0...dimension) {
    // Espaciado izquierdo
    System.write(" " * i)
    // Lado izquierdo
    System.write("\\" * (dimension - i))
    // Lado derecho
    System.print("/" * (dimension - i))
  }
}

// Muestra 5 diamantes de tama√±o 0 al 5:
for(dimension in 0..5) {
  mostrarDiamanteLineal.call(dimension)
  System.print()
  mostrarDiamanteRelleno.call(dimension)
  System.print()
}</programlisting>
</section>
</section>
<section xml:id="_carrera_de_caracoles">
<title>Carrera de Caracoles</title>
<simpara>Una alucinante carrera entre 2 a 8 caracoles.
Basado en <link xl:href="https://github.com/asweigart/PythonStdioGames/blob/main/src/gamesbyexample/snailrace.py">SnailRace</link>.</simpara>
<formalpara>
<title>Nivel</title>
<para>Intermedio</para>
</formalpara>
<section xml:id="_ejemplo_de_ejecuci√≥n_4">
<title>Ejemplo de Ejecuci√≥n</title>
<simpara><literal>$ ./wren caracoles/caracoles.wren</literal></simpara>
<screen linenumbering="numbered">La gran carrera de caracoles

    @v &lt;-- caracol


¬øCu√°ntos caracoles correr√°n? Min:2 Max:8
2
Ingresa el nombre del caracol #1:
Ana
Ingresa el nombre del caracol #2:
Berto

INICIO                                  META
|                                       |
                                     Ana
.....................................@v
                                       Berto
.......................................@v
¬°Ha ganado Berto!</screen>
</section>
<section xml:id="_c√≥digo_fuente_4">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">/*
Snail Race, por Al Sweigart &lt;al@inventwithpython.com&gt;
https://github.com/asweigart/PythonStdioGames/blob/main/src/gamesbyexample/snailrace.py
Una carrera de caracoles, ¬°alucinante!.
Adaptado a Wren por Camilo Castro &lt;camilo@ninjas.cl&gt;
https://github.com/NinjasCL/wren-libro/blob/main/juegos/caracoles/caracoles.wren
- Tags: short, beginner, artistic, corto, novato, artistico
- Version: 1.0.0
*/
import "random" for Random
import "timer" for Timer
import "io" for Stdin

var random = Random.new()

class Constantes {
  static minCaracoles { 2 }
  static maxCaracoles { 8 }
  static maxLargoNombre { 20 }
  static meta { 40 }
}


System.print("
La gran carrera de caracoles

    @v &lt;-- caracol

")

var cantidad = null

while (true) {
  System.print("¬øCu√°ntos caracoles correr√°n? Min:%(Constantes.minCaracoles) Max:%(Constantes.maxCaracoles)")
  cantidad = Num.fromString(Stdin.readLine())
  if (cantidad &amp;&amp; cantidad &gt;= Constantes.minCaracoles &amp;&amp; cantidad &lt;= Constantes.maxCaracoles) {
    break
  }
  System.print("Ingresar un n√∫mero entre %(Constantes.minCaracoles) y %(Constantes.maxCaracoles)")
}

var nombres = []

for (i in 1..cantidad) {
  var nombre = ""
  while (true) {
    
    System.print("Ingresa el nombre del caracol #%(i):")
    nombre = Stdin.readLine()

    // Reducimos el nombre a su largo m√°ximo
    nombre = nombre.take(Constantes.maxLargoNombre).join()
    
    if (nombre.count == 0) {
      System.print("Por favor ingresa un nombre.")
    } else if (nombres.contains(nombre)) {
      System.print("Nombre ya existe")
    } else {
      break
    }
  }
  nombres.add(nombre)
}

System.print("\n" * 40)
System.print("INICIO" + " " * (Constantes.meta - "INICIO".count) + "META")
System.print("|" + " " * (Constantes.meta - "|".count) + "|")

var caracoles = {}

for (nombre in nombres) {
  System.print(nombre)
  System.print("@v")
  caracoles[nombre] = 0
}

// 1.5 segundos
Timer.sleep(15 * 100)

while (true) {

  for (i in 0..(random.int(1, cantidad + 1))) {
    var nombre = random.sample(nombres)
    caracoles[nombre] = caracoles[nombre] + 1

    if (caracoles[nombre] &gt;= Constantes.meta) {
      System.print("¬°Ha ganado %(nombre)!")
      // Terminar el proceso del juego
      Fiber.yield()
    }
  }

  // 0.5 segundos
  Timer.sleep(500)

  System.print("\n" * 40)
  System.print("INICIO" + " " * (Constantes.meta - "INICIO".count) + "META")
  System.print("|" + " " * (Constantes.meta - "|".count) + "|")

  for (nombre in nombres) {
    var espacios = caracoles[nombre]
    System.print(" " * espacios + nombre)
    System.print("." * espacios + "@v")
  }
}</programlisting>
</section>
</section>
<section xml:id="_ca√±on">
<title>Ca√±on</title>
<simpara>Este juego simula el disparo de un ca√±√≥n hacia un objetivo.
C√≥digo levemente basado en <xref linkend="alfonseca"/>.</simpara>
<formalpara>
<title>Nivel</title>
<para>Intermedio</para>
</formalpara>
<section xml:id="_c√≥mo_jugar">
<title>¬øC√≥mo Jugar?</title>
<simpara>El jugador debe ingresar el √°ngulo para cada tiro del ca√±√≥n.</simpara>
</section>
<section xml:id="_ejemplo_de_ejecuci√≥n_5">
<title>Ejemplo de Ejecuci√≥n</title>
<screen linenumbering="numbered">Quedan 1 objetivos
El ca√±√≥n puede disparar hasta 34595 metros
El objetivo est√° a 6788 metros
La f√≥rmula de la distancia es: alcance * sin(2 * √°ngulo * œÄ / 180)

Ingrese el √°ngulo para disparar
5
Distancia Alcanzada: 10690 Distancia Objetivo: 6788

El tiro se pas√≥ en 3902 metros.
¬°Prueba otra vez!, quedan 4 tiros

Ingrese el √°ngulo para disparar
3.1
Distancia Alcanzada: 6695 Distancia Objetivo: 6788

!!BooOOOM!!
¬°Felicidades!, haz destruido al objetivo en 2 intentos.</screen>
</section>
<section xml:id="_c√≥digo_fuente_5">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">/**
Juego que simula el disparo de un ca√±√≥n hacia un objetivo.
El jugador debe ingresar el √°ngulo para cada tiro del ca√±√≥n.
C√≥digo levemente basado en la obra "C√≥mo construir juegos de aventura"
de Manuel Afonseca. ISBN 84-7688-019-7
- Author: Camilo Castro &lt;camilo@ninjas.cl&gt;
- Version: 1.0.0
*/

import "random" for Random
import "io" for Stdin

var random = Random.new()

var alcance = 0

var objetivos = 3
var oportunidades = 5

// √Ångulos deben estar en grados
// m√≠nimo 0.5, m√°ximo 89.5
var anguloElevacion = 0.5
var anguloMinimo = 0.5
var anguloMaximo = 89.5

// Sentinela para saber si el objetivo fue destruido
var destruido = false

// Para saber cuantos tiros fueron
// necesarios para destruir al objetivo
var tiros = 0

// Distancia m√≠nima requerida para considerar
// al objetivo como destruido
// Si el proyectil llega a los 100 metros del objetivo
// se considera destruido
// (en metros).
var distanciaMinima = 100

// Distancia alcanzada por el tiro (en metros)
var distanciaAlcanzada = 0

// Distancia final
// distanciaAlcanzada - distanciaObjetivo
var distanciaFinal = 0

// Distancia al azar del objetivo
// Debe ser igual o menor al alcance del ca√±√≥n
// entre 100 hasta el alcance del ca√±√≥n.
var distanciaObjetivo = 0

var jugar = true
while (jugar) {

  System.print("Quedan %(objetivos) objetivos")

  // Valores iniciales por cada objetivo
  oportunidades = 5
  destruido = false
  anguloElevacion = 0
  distanciaFinal = 0
  tiros = 1
  
  // Un n√∫mero aleatorio entre 10K y 50K
  // Usamos notaci√≥n cient√≠fica para simplificar el n√∫mero
  alcance = random.int(10e3, 50e3 + 1)

  distanciaObjetivo = random.int(distanciaMinima, alcance + 1)

  System.print("El ca√±√≥n puede disparar hasta %(alcance) metros")
  System.print("El objetivo est√° a %(distanciaObjetivo) metros")
  System.print("La f√≥rmula de la distancia es: alcance * sin(√°ngulo * 2 * œÄ / 180)")

  while (oportunidades &gt; 0) {

    while (anguloElevacion &lt; anguloMinimo || anguloElevacion &gt; anguloMaximo) {
      System.print()
      System.print("Ingrese el √°ngulo para disparar")
      anguloElevacion = Num.fromString(Stdin.readLine())

      if (!anguloElevacion) {
        System.print("Debe ingresar un √°ngulo.")
        anguloElevacion = 0
      } else if (anguloElevacion &gt; anguloMaximo) {
        System.print("El √°ngulo debe ser menor a %(anguloMaximo)")
      } else if (anguloElevacion &lt; anguloMinimo) {
        System.print("El √°ngulo debe ser mayor a %(anguloMinimo)")
      }
    }

    // Calculamos la distancia que el tiro llega con el √°ngulo ingresado.
    // La f√≥rmula matem√°tica (√°ngulo * 2œÄ/180) convierte los grados del √°ngulo de
    // a radianes. Considerando 360¬∫.
    // Luego se multiplica el alcance por el seno de los radianes obtenidos
    // para obtener la distancia alcanzada.
    // Finalmente se redondea el resultado para obtener un n√∫mero entero.
    // Ver: http://math2.org/math/trig/es-tables.htm
    // Ver: https://es.khanacademy.org/science/physics/two-dimensional-motion/two-dimensional-projectile-mot/v/projectile-at-an-angle

    distanciaAlcanzada = (alcance * (anguloElevacion * ( 2 * Num.pi / 180)).sin).round
    distanciaFinal = (distanciaAlcanzada - distanciaObjetivo).abs
    System.print("Distancia Alcanzada: %(distanciaAlcanzada.abs) Distancia Objetivo: %(distanciaObjetivo) Diferencia: %(distanciaFinal)")

    destruido = (distanciaMinima &gt;= distanciaFinal)

    if (destruido) {
      objetivos = objetivos - 1
      jugar = (objetivos &gt; 0)
      System.print()
      System.print("!!BooOOOM!!")
      System.print("¬°Felicidades!, haz destruido al objetivo en %(tiros) intentos.")
      System.print()
      break
    }

    // Aumentamos el contador de tiros
    tiros = tiros + 1

    // Y reiniciamos el angulo de elevaci√≥n
    // para volver a solicitarlo
    anguloElevacion = 0
    oportunidades = oportunidades - 1
    System.print()

    if (distanciaAlcanzada &gt; distanciaObjetivo) {
      System.print("El tiro se pas√≥ en %(distanciaFinal) metros.")
    } else {
      System.print("El tiro qued√≥ corto por %(distanciaFinal) metros.")
    }
    
    jugar = (oportunidades &gt; 0)
    if (jugar) {
      System.print("¬°Prueba otra vez!, quedan %(oportunidades) tiros")
    } else {
      System.print("Juego terminado. ¬°Haz perdido todas tus balas!")
    }
  }
}</programlisting>
</section>
</section>
</section>
<section xml:id="_gr√°ficos">
<title>Gr√°ficos</title>
<simpara>Aplicaciones que necesitan <link xl:href="http://tic80.com/"><emphasis>TIC 80</emphasis></link> u <link xl:href="https://domeengine.com/"><emphasis>Dome Engine</emphasis></link> para ser ejecutados.</simpara>
<section xml:id="_breakout">
<title><link xl:href="https://github.com/NinjasCL/breakout">Breakout</link></title>
<simpara>Un clon simple del famoso juego de <emphasis>Breakout</emphasis>.
Debes eliminar todos los bloques dentro de la pantalla utilizando
una raqueta y una pelota. El juego termina si la raqueta falla
en golpear la pelota.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://raw.githubusercontent.com/NinjasCL/breakout/main/breakout.gif"/>
</imageobject>
<textobject><phrase>Breakout</phrase></textobject>
</inlinemediaobject></simpara>
<formalpara>
<title>Nivel</title>
<para>Avanzado</para>
</formalpara>
<section xml:id="_c√≥digo_fuente_6">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">// title:  Clone de breakout para TIC-80
// author: Camilo Castro
// desc:   Un simple clon de breakout en Wren
// script: wren
// based on: https://github.com/digitsensitive/tic-80-tutorials/tree/master/tutorials/breakout

import "random" for Random

var Seed = Random.new()
var T = TIC

class ScreenWidth {
    static min {0}
    static max {240}
}

class ScreenHeight {
    static min {0}
    static max {136}
}
    
class Screen {
    static height {ScreenHeight}
    static width {ScreenWidth}
}

class Input {
    static left {T.btn(2)}
    static right {T.btn(3)}
    static x {T.btn(5)}
}

class Color {
    static black {0}
    static white {12}
    static orange {3}
    static greyl {13}
    static greyd {15}
}

class Collisions {
   // Implements
  // https://developer.mozilla.org/en-US/docs/Games/Techniques/2D_collision_detection
  static collide(hitbox, hitbox2) {
    return (hitbox.x &lt; hitbox2.x + hitbox2.width &amp;&amp;
            hitbox.x + hitbox.width &gt; hitbox2.x &amp;&amp;
            hitbox.y &lt; hitbox2.y + hitbox2.height &amp;&amp;
            hitbox.y + hitbox.height &gt; hitbox2.y)
  }
}

class PlayerSpeed {
    x {_x}
    x = (value) {
        _x = value
    }
    
    max {_max}
    max = (value) {
        _max = value
    }
    
    construct new() {
        _x = 0
        _max = 4
    }
}

class Player {
    x {_x}
    y {_y}
    width {_width}
    height {_height}
    color {_color}
    speed {_speed}

    state {_state}

    construct new(state) {
        _state = state
        _width = 24
        _height = 4
        _y = 120
        _color = Color.orange
        reset()
    }

    reset() {
        _x = (Screen.width.max/2) - _width/2
        _speed = PlayerSpeed.new()
    }

    draw() {
        T.rect(x, y, width, height, color)
    }

    wall() {
        if (x &lt; Screen.width.min) {
            _x = Screen.width.min
        } else if(x + width &gt; Screen.width.max) {
            _x = Screen.width.max - width
        }
    }

    collisions() {
        wall()
    }

    update() {
        _x = x + speed.x
        if (speed.x != 0) {
            if (speed.x &gt; 0) {
              speed.x = speed.x - 1
            } else {
              speed.x = speed.x + 1
            }
        }
    }

    input() {
        if (Input.left) {
                if (speed.x &gt; -speed.max) {
                    speed.x = speed.x - 2
                } else {
                    speed.x = -speed.max
                }
            }
            
            if (Input.right) {
                if (speed.x &lt; speed.max) {
                        speed.x = speed.x + 2
                    } else {
                        speed.x = speed.max
                    }
            }
    }
}

class BallSpeed {
    x {_x}
    x = (value) {
        _x = value
    }
    
    y {_y}
    y = (value) {
        _y = value
    }
    
    max {_max}
    
    construct new() {
        _x = 0
        _y = 0
        _max = 1.5
    }
}

class Ball {
    x {_x}
    y {_y}
    width {_width}
    height {_height}
    color {_color}
    deactive {_deactive}
    speed {_speed}
    
    player {_player}
    player = (value) {
        _player = value
    }
    
    state {_state}
    
    construct new(player, state) {
        _width = 3
        _height = 3
        _color = Color.greyl
        _player = player
        _state = state
        reset()
    }
    
    position() {
        _x = player.x + (player.width / 2) - 1.5
        _y = player.y - 5
    }
    
    reset() {
        position()
        _deactive = true
        _speed = BallSpeed.new()
    }
    
    input() {
        if (deactive) {
                position()
                if (Input.x) {
                    speed.x = (Seed.float(0, 10).floor * 2) - 1
                        speed.y = speed.y - 1.5
                        _deactive = false
                }
            }
    }
    
    wall() {
        // top
        if (y &lt; 0) {
            speed.y = -speed.y
            
        // left
        } else if (x &lt; 0) {
            speed.x = -speed.x
        
        // right
        } else if (x &gt; 240 - width) {
            speed.x = -speed.x
        }
    }
    
    ground() {
        if (y &gt; 136 - width) {
                reset()
                state.lifeDown()
        }
    }
    
    paddle() {
        if (Collisions.collide(this, player)) {
            speed.y = -speed.y
            speed.x = speed.x + 0.3 * player.speed.x
        } 
    }
    
    brick(brick) {

        // collide left or right side
        if (brick.y &lt; y &amp;&amp;
            y &lt; brick.y + brick.height &amp;&amp;
            (x &lt; brick.x || brick.x + brick.width &lt; x)) {
                speed.x = -speed.x
            }
        // collide top or bottom
        if (y &lt; brick.y ||
        (y &gt; brick.y &amp;&amp; brick.x &lt; x &amp;&amp;
        x &lt; brick.x + brick.width)) {
            speed.y = -speed.y
        }
    }

    collisions() {
        wall()
        ground()
        paddle() 
    }
    
    update() {
        _x = x + speed.x
        _y = y + speed.y
        
        if (speed.x &gt; speed.max) {
            speed.x = speed.max
        }
    }
    
    draw() {
        T.rect(x, y, width, height, color)
    }
}

class Brick {
    x {_x}
    y {_y}
    width {_width}
    height {_height}
    color {_color}

    construct new(x, y, color) {
        _x = x
        _y = y
        _width = 10
        _height = 4
        _color = color
    }
    
    draw() {
        T.rect(x, y, width, height, color)
    }
}

class Board {
    width {19}
    height {12}

    ball {_ball}
    state {_state}

    bricks {
        if (!_bricks) {
            _blicks = []
        }

        return _bricks
    }
        
    construct new(ball, state) {
        _ball = ball
        _state = state
        reset()
    }

    reset() {
        _bricks = []
        for (i in 0..height) {
            for (j in 0..width) {
                var x = 10 + j * 11
                var y = 10 + i * 5
                var color = i + 1
                var brick = Brick.new(x, y, color)
                bricks.add(brick)
            }
        }
								ball.reset()
    }
        
    draw() {
        bricks.each {|brick|
            brick.draw()
        }
    }
    
    collisions() {
        var index = 0
        if (bricks.count &lt;= 0) {
            reset()
        }

        var note = "C-%(Seed.int(4,7))"

        bricks.each {|brick|
            if (Collisions.collide(ball, brick)) {
                T.sfx(0, note, 10)
                bricks.removeAt(index)
                ball.brick(brick)
                state.scoreUp()
            }
            index = index + 1
        }
    }
    
    update() {}
    input() {}
}

class Stage {
    objects {_objects}
    state {_state}
    
    construct new(state) {
        _objects = []
        _state = state
    }
    
    add(object) {
        objects.add(object)
    }
    
    input() {
        if (!state.isPlaying) return
        
        objects.each {|object|
            object.input()
        }
    }
    
    draw() {
        if (!state.isPlaying) return
        
        objects.each {|object|
            object.draw()
        }
    }
    
    update() {
    
        if (!state.isPlaying) return
        
        objects.each {|object|
            object.update()
        }
    }
    
    collisions() {
        if (!state.isPlaying) return 
        
        objects.each {|object|
            object.collisions()
        }
    }
}

class GUI {
    player {_player}
    state {_state}
    
    construct new(player, state) {
        _player = player
        _state = state
    }
    
    scores() {
       // shadow
        T.print("SCORE ", 5, 1, Color.greyd)
        T.print(state.score, 40, 1, Color.greyd)
        
        // forecolor
        T.print("SCORE ", 5, 0, Color.white)
        T.print(state.score, 40, 0, Color.white)
        
        // shadow
        T.print("LIVES ", 190, 1, Color.greyd)
        T.print(state.lives, 225, 1, Color.greyd)
        
        // forecolor
        T.print("LIVES ", 190, 0, Color.white)
        T.print(state.lives, 225, 0, Color.white)
    }
    
    gameover() {
      T.print("Game Over", (Screen.width.max/2) - 6 * 4.5, 136/2, Color.white) 
    }
    
    input() {
        if (!state.isPlaying &amp;&amp; Input.x) {
            state.start()
        }
    }
    
    draw() {
        if (state.isPlaying) {
            return scores()
        }
        gameover()
    }
}

class GameState {
    static game {__game}
    static game = (value) {
        __game = value
    }

    static isPlaying {__playing}
    
    static score {
        if (!__score) {
            __score = 0
        }
        
        return __score
    }
    
    static score = (value) {
        __score = value
    }
    
    static lives {
        if (!__lives || __lives &lt; 0) {
            __lives = 3
        }
        
        return __lives
    }
    
    static lives = (value) {
        if (value &lt; 0) {
            over()
        }
        __lives = value
    }
    
    static over() {
        reset()
        __playing = false
    }
    
    static start() {
        __playing = true
    }
    
    static lifeDown() {
        lives = lives - 1
    }
    
    static scoreUp() {
        score = score + 100
    }
    
    static reset() {
        score = 0
        lives = 3
        game.reset()
    }
}



class Game is TIC {
    player {_player }
    stage {_stage }
    gui {_gui }
    
    construct new() {
        reset()
    }

    reset() {
        GameState.start()
        GameState.game = this

        _player = Player.new(GameState)
        _ball = Ball.new(_player, GameState)
        
        _gui = GUI.new(_player, GameState)
        
        _board = Board.new(_ball, GameState)
            
        _stage = Stage.new(GameState)
        _stage.add(_player)
        _stage.add(_ball)
        _stage.add(_board)
    }
    
    TIC() {
        T.cls(0)
        input()
        update()
        collisions()
        draw()
    }
    
    input() {
        gui.input()
        stage.input()
    }
    
    update() {
        stage.update()
    }
    
    collisions() {
        stage.collisions()
    }
    
    draw() {
        stage.draw()
        gui.draw()
    }
}</programlisting>
</section>
</section>
<section xml:id="_snake">
<title><link xl:href="https://github.com/NinjasCL/snake">Snake</link></title>
<simpara>Un clon simple del famoso juego de la serpiente.
Si come se agranda su cola y el juego termina al momento de que la cabeza
toque una parte de su propio cuerpo.</simpara>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="https://raw.githubusercontent.com/NinjasCL/snake/main/game.gif"/>
</imageobject>
<textobject><phrase>Snake</phrase></textobject>
</inlinemediaobject></simpara>
<formalpara>
<title>Nivel</title>
<para>Avanzado</para>
</formalpara>
<section xml:id="_c√≥digo_fuente_7">
<title>C√≥digo fuente</title>
<programlisting language="js" linenumbering="numbered">// title:  Clone de Snake para TIC-80
// author: Camilo castro
// desc:   Un peque√±o clon de Snake
// script: wren
// based on: https://github.com/nesbox/TIC-80/wiki/Snake-Clone-tutorial

import "random" for Random

var Rand = Random.new()
var T = TIC

class Input {
		static up {T.btn(0)}
		static down {T.btn(1)}
		static left {T.btn(2)}
		static right {T.btn(3)}
		static x {T.btn(5)}
}

class Color {
  static black {0}
		static white {12}
		static green {5}
		static blue {10}
		static orange {3}
		static greyd {15} 
}

class Screen {
  static width {240}
		static height {136}
}

class Position {
  x {
		if (!_x) {
			_x = 0
			}
			return _x
		}
		
		x = (value) {
		_x = value
		}
		
		y {
		if (!_y) {
			_y = 0
			}
			return _y
		}
		
		y = (value) {
		_y = value
		}
		
		construct new(x, y) {
			_x = x
			_y = y
		}
}

class GameState {
  static game {__game}
		static game = (value) {
			__game = value
		}
		
		static snake {__snake}
		static snake = (value) {
			__snake = value
		}
		
		static score {
			if (!__score) {
				__score = 0
			}
			return __score
		} 
		
		static scoreUp() {
			__score = score + 100
		}
		
  static frame {
		if (!__frame || __frame &gt; Num.largest - 1) {
					__frame = 0
				}
				return __frame
		}
		
		static frameUp() {
			__frame = frame + 1
		}
		
		static isTenthFrame {frame % 10 == 0}
		
		static isPlaying {
			if (__isPlaying is Null) {
				__isPlaying = true
			}
			return __isPlaying
		}
		
		static isPlaying = (value) {
			__isPlaying = value
		}
		
		static start() {
			isPlaying = true
		}
		
		static gameover() {
			reset()
				isPlaying = false
		}
		
		static reset() {
			__score = 0
			game.reset()
		} 
}

class Food is Position {
	snake {_snake}
	
	construct new (snake) {
			_snake = snake
			place()
	}
	
	random() {
		x = Rand.int(0, 29)
		y = Rand.int(0, 16)
	}
	
	place() {
		random()
		snake.body.each{|part|
			if (part.x == x &amp;&amp; part.y == y) {
					place()
			}
		}
	}
	
	draw() {
	  T.rect(x * 8, y * 8, 8, 8, Color.orange)
	}
	
	update() {}
	input() {}
	
	collisions() {
		snake.eat(this)
	}
}

class Direction {
	static directions {
		if (!__directions) {
				__directions = [
						Position.new(0, -1), // up
						Position.new(0, 1), // down
						Position.new(-1, 0), // left
						Position.new(1, 0) // right
				]
			}
			return __directions
		}
		
		static up {directions[0]}
		static down {directions[1]}
		static left {directions[2]}
		static right {directions[3]}
}

class Snake {
  tail {body[0]}
		neck {body[body.count - 2]}
		head {body[body.count - 1]}
		body {
			if (!_body) {
					var tail = Position.new(15, 8)
					var neck = Position.new(14, 8)
					var head = Position.new(13, 8)
					_body = [tail, neck, head]				 
				}
				return _body
		}
		
		direction {
			if (!_direction) {
				_direction = Direction.up
			}
			return _direction
		}
		
		state {_state}
		
		construct new(state) {
			_state = state
		}
		
		reset() {
			_body = null
			_direction = Direction.up
		}
		
		input() {
			var last = direction
			
			if (Input.up) {
				_direction = Direction.up
			}
			
			if (Input.down) {
				_direction = Direction.down
			}
			
			if (Input.left) {
				_direction = Direction.left
			}
			
			if (Input.right) {
				_direction = Direction.right
			}
			
			if (head.x + direction.x == neck.x &amp;&amp;
				head.y + direction.y == neck.y) {
					_direction = last
			}
		}
		
		draw() {
			body.each{|part|
			 T.rect(part.x * 8, part.y * 8, 8, 8, Color.blue)
			}
		}
		
		update() {
		
			var x = (head.x + direction.x) % 30
			if (x &lt; 0) {
				x = 29
			}
			
			var y = (head.y + direction.y) % 17
			if (y &lt; 0) {
				y = 17
			}
			
			var part = Position.new(x, y)
			
			body.add(part)
		}
		
		removeTail() {
			body.removeAt(0)
		}
		
		eat(food) {
			if (head.x == food.x &amp;&amp; head.y == food.y) {
				T.sfx(0, "C-5", 10)
				state.scoreUp()
				food.place()
			} else {
				removeTail()
			}
		}
		
		collisions() {
				
				// Search if head collisions with body parts
				// omit last part since its the head
			body[0...(body.count - 1)].each{|part|
					if (head.x == part.x &amp;&amp; head.y == part.y) {
							state.gameover()
					}
			}
		}
}

class Stage {
  items {_items}
		
	construct new() {
		_items = []
	}
		
  add(object) {
			items.add(object)
	}
		
  input() {
			items.each{|object|
					object.input()
			}
	}
		
	draw() {
		items.each{|object|
			object.draw()
		}
	}
	
	update() {
		items.each{|object|
			object.update()
		}
	}
	
	collisions() {
		items.each{|object|
			object.collisions()
		}
	}
}

class GUI {
		state {_state}
		
		construct new(state) {
			_state = state
		}
		
		score() {
			T.print("SCORE %(state.score)", 5, 5, Color.blue)
			T.print("SCORE %(state.score)", 5, 4, Color.white)
		}
		
		gameover() {
			T.cls(Color.black)
			T.print("Game Over", (Screen.width/2) - 6 * 4.5, (Screen.height / 2), Color.white)
		}
		
		input() {
			if (!state.isPlaying &amp;&amp; Input.x) {
					state.start()
			}
		}
		
		update() {}
		collisions() {}
		
		draw() {
			if (state.isPlaying) {
					return score()
			}
			gameover()
		}
}

class Game is TIC {
		stage {
			if (!_stage) {
					GameState.game = this
					_stage = Stage.new()
					_stage.add(snake)
					_stage.add(food)
					_stage.add(gui)
			}
			return _stage
		}
		
		gui {
			if (!_gui) {
				_gui = GUI.new(GameState)
			}
			return _gui
		}
		
		snake {
			if (!_snake) {
				_snake = Snake.new(GameState)
				GameState.snake = _snake
			}
			return _snake
		}
		
		food {
			if (!_food) {
				_food = Food.new(snake)
			}
			return _food
		}
		
		construct new() {
				reset()
		}
		
		reset() {
			snake.reset()
		}
		
		TIC() {
			T.cls(Color.green)
			GameState.frameUp()
			input()
			
			if (GameState.isTenthFrame) { 
				update()
				collisions()
			}

			draw()
		}
		
		input() {
			stage.input()
		}
		
		update() {
			stage.update()
		}
		
		collisions() {
			stage.collisions()
		}
		
		draw() {
			stage.draw()
		}
}</programlisting>
</section>
</section>
</section>
</chapter>
<chapter xml:id="_soluciones_a_ejercicios">
<title>Soluciones a Ejercicios</title>
<simpara>Las siguientes son las soluciones a los ejercicios planteados en el libro. No necesariamente son la √∫nica forma de resolverlos. Se recomienda intentar resolver los ejercicios antes de ver las soluciones.</simpara>
<section xml:id="_cap√≠tulo_1">
<title>Cap√≠tulo 1</title>
<section xml:id="chap1-ex1-sol">
<title>Soluci√≥n: <xref linkend="chap1-ex1"/></title>
<formalpara>
<title>Ejecuci√≥n</title>
<para><literal>$ ./wren hola.wren</literal></para>
</formalpara>
<formalpara>
<title>Salida</title>
<para>
<screen linenumbering="numbered">¬°Hola Wren!</screen>
</para>
</formalpara>
<formalpara>
<title>C√≥digo</title>
<para>
<programlisting language="js" linenumbering="numbered">// muestra: ¬°Hola Wren!
System.print("¬°Hola Wren!")</programlisting>
</para>
</formalpara>
</section>
</section>
<section xml:id="_cap√≠tulo_3">
<title>Cap√≠tulo 3</title>
<section xml:id="chap3-ex1-sol">
<title>Soluci√≥n: <xref linkend="chap3-ex1"/></title>
<formalpara>
<title>Ejecuci√≥n</title>
<para><literal>$ ./wren donas.wren</literal></para>
</formalpara>
<formalpara>
<title>C√≥digo</title>
<para>
<programlisting language="js" linenumbering="numbered">var donas = Fn.new {|cantidad|
  // Tu c√≥digo aqu√≠
  var mensaje = "N√∫mero de donas:"
  if (cantidad &gt;= 10) {
    return "%(mensaje) muchas"
  }
  return "%(mensaje) %(cantidad)"
}


// Pruebas para evaluar que el ejercicio
// se ha completado exitosamente.
// no modificar.

var probar = Fn.new {|tengo, quiero|
  var prefijo = " X "
  if (tengo == quiero) {
    prefijo = " OK "
  }
  System.print("%(prefijo) tengo: %(tengo) quiero: %(quiero)")
}

System.print("Probando donas")
probar.call(donas.call(4), "N√∫mero de donas: 4")
probar.call(donas.call(9), "N√∫mero de donas: 9")
probar.call(donas.call(10), "N√∫mero de donas: muchas")
probar.call(donas.call(99), "N√∫mero de donas: muchas")
System.print()</programlisting>
</para>
</formalpara>
</section>
</section>
</chapter>
<glossary xml:id="_glosario">
<title>Glosario</title>
<simpara>Lista de conceptos utilizados a lo largo de este documento.</simpara>
<glossentry>
<glossterm>class</glossterm>
<glossdef>
<simpara>Significa <emphasis>"clase"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>call</glossterm>
<glossdef>
<simpara>Significa <emphasis>"llamar"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>construct</glossterm>
<glossdef>
<simpara>Significa <emphasis>"constructor"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>object</glossterm>
<glossdef>
<simpara>Significa <emphasis>"objeto"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>start</glossterm>
<glossdef>
<simpara>Inicio, principio, comienzo.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>end</glossterm>
<glossdef>
<simpara>Fin, t√©rmino, final.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>each</glossterm>
<glossdef>
<simpara>Palabra que significa <emphasis>"cada uno"</emphasis>. Usado en ciclos iterativos para evaluar cada uno de los elementos.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>for</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"para"</emphasis>. Usada dentro de los bucles y en conjunto a la instruacci√≥n <emphasis>"import"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>foreign</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"extranjero"</emphasis>. Usada para indicar que la clase, propiedad o variable ser√° implementada fuera de <emphasis>Wren</emphasis>. Normalmente cuando se necesita utilizar c√≥digo en otros lenguajes como <emphasis>C</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>false</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"falso"</emphasis>. Usado para indicar una condici√≥n no se est√° cumpliendo. Su contraparte es la instrucci√≥n <emphasis>"true"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>fiber</glossterm>
<glossdef>
<simpara>Significa <emphasis>"fibra"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>fn</glossterm>
<glossdef>
<simpara>Significa <emphasis>"funci√≥n"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>funci√≥n</glossterm>
<glossdef>
<simpara>Bloque de c√≥digo que puede ser ejecutado en distintos puntos del ciclo de vida del c√≥digo. Tambi√©n puede ser asignado a variables.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>new</glossterm>
<glossdef>
<simpara>Significa <emphasis>"nuevo"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>print</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"mostrar"</emphasis> o <emphasis>"imprimir"</emphasis>. Usado para mostrar un valor.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>par√°metro</glossterm>
<glossdef>
<simpara>Son variables que son enviados a las funciones. Pueden ser por valor o por referencia.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>static</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"est√°tico"</emphasis>. Usado para indicar que una propiedad o m√©todo de una clase no necesita una instancia para ser invocado.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>string</glossterm>
<glossdef>
<simpara>Significa <emphasis>"cadena de caracteres"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>int</glossterm>
<glossdef>
<simpara>Significa <emphasis>"n√∫mero entero"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>float</glossterm>
<glossdef>
<simpara>Significa <emphasis>"n√∫mero decimal con punto flotante"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>random</glossterm>
<glossdef>
<simpara>Signfica <emphasis>"aleatorio"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>num</glossterm>
<glossdef>
<simpara>Significa <emphasis>"n√∫mero"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>true</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"verdadero"</emphasis>. Usado para indica una condici√≥n que si se cumple. Su contraparte es la instrucci√≥n <emphasis>"false"</emphasis>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>trim</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"cortar"</emphasis>. Usado para eliminar caracteres dentro de un string.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>import</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"incluir"</emphasis>. Obtener datos desde un archivo e incluir sus contenidos en el contexto.
Ejemplo <literal>import "random" for Random</literal>.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>if</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"si"</emphasis>. Permite crear una condicional y controlar el flujo de datos dentro de un programa.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>is</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"es"</emphasis>. Permite evaluar si un objeto es miembro de un tipo de clase.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>else</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"en otro caso"</emphasis>. Normalmente usado para indicar una condici√≥n alternativa si la condici√≥n <emphasis>"if"</emphasis> principal no se cumple.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>var</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"variable"</emphasis>. Usado para declarar una nueva variable.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>while</glossterm>
<glossdef>
<simpara>Instrucci√≥n que significa <emphasis>"mientras"</emphasis>. Usada dentro de los bucles.</simpara>
</glossdef>
</glossentry>
<glossentry>
<glossterm>write</glossterm>
<glossdef>
<simpara>Instrucci√≥n que signiica <emphasis>"escribir"</emphasis>.</simpara>
</glossdef>
</glossentry>
</glossary>
<bibliography xml:id="_bibliograf√≠a">
<title>Bibliograf√≠a</title>
<simpara>Una lista de recursos complementarios y referenciales.</simpara>
<bibliodiv>
<title>Libros</title>
<bibliomixed>
<bibliomisc><anchor xml:id="inventwithpython" xreflabel="[inventwithpython]"/>[inventwithpython] Albert Sweigart. 'Inventa tus Propios Juegos de computadora con Python'. <link xl:href="http://inventwithpython.com/es">http://inventwithpython.com/es</link>. ISBN 978-1514370926</bibliomisc>
</bibliomixed>
<bibliomixed>
<bibliomisc><anchor xml:id="alfonseca" xreflabel="[alfonseca]"/>[alfonseca] Manuel Alfonseca. 'C√≥mo construir juegos de aventura'. <link xl:href="https://worldofspectrum.org/archive/books/enciclopedia-practica-de-la-informatica-aplicada-1-como-construir-juegos-de-aventura">https://worldofspectrum.org/archive/books/enciclopedia-practica-de-la-informatica-aplicada-1-como-construir-juegos-de-aventura</link>. ISBN 84-7688-019-7</bibliomisc>
</bibliomixed>
</bibliodiv>
<bibliodiv>
<title>Sitios Web</title>
<bibliomixed>
<bibliomisc><anchor xml:id="introtopython" xreflabel="[introtopython]"/>[introtopython] Eric Matthes. 'Introduction to Python' <link xl:href="https://github.com/ehmatthes/intro_programming">https://github.com/ehmatthes/intro_programming</link></bibliomisc>
</bibliomixed>
<bibliomixed>
<bibliomisc><anchor xml:id="googlepython" xreflabel="[googlepython]"/>[googlepython] Google. 'Python Class' <link xl:href="http://code.google.com/edu/languages/google-python-class/">http://code.google.com/edu/languages/google-python-class/</link></bibliomisc>
</bibliomixed>
<bibliomixed>
<bibliomisc><anchor xml:id="puntoflotante" xreflabel="[puntoflotante]"/>[puntoflotante] Michael Borgwardt. <link xl:href="https://github.com/Pybonacci/puntoflotante.org">https://github.com/Pybonacci/puntoflotante.org</link></bibliomisc>
</bibliomixed>
<bibliomixed>
<bibliomisc><anchor xml:id="rosettacode-wren" xreflabel="[rosettacode-wren]"/>[rosettacode-wren] Rosetta Code. <link xl:href="https://rosettacode.org/wiki/Category:Wren">https://rosettacode.org/wiki/Category:Wren</link></bibliomisc>
</bibliomixed>
</bibliodiv>
</bibliography>
<index xml:id="_√çndice">
<title>√çndice</title>

</index>
<colophon xml:id="_colof√≥n">
<title>Colof√≥n</title>
<simpara>Escrito por <link xl:href="https://ninjas.cl">Camilo Castro</link> y <link xl:href="https://github.com/ninjascl/wren-adventures/graphs/contributors">colaboradores</link>. Para <link xl:href="https://ninjas.cl">Ninjas.cl</link>.</simpara>
<simpara>Esta obra est√° bajo una <link xl:href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Atribuci√≥n-No-Comercial-Compartir-Igual 4.0 Internacional</link></simpara>
<simpara><link xl:href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><inlinemediaobject>
<imageobject>
<imagedata fileref="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/>
</imageobject>
<textobject><phrase>Licencia Creative Commons</phrase></textobject>
</inlinemediaobject></link></simpara>
</colophon>
</book>