## http://wren.io/modules/core/string.html[Strings: Cadena de caracteres]

Las cadenas de caracteres (_String_) son delimitadas por las comillas dobles (`"`). Pueden ser de una sola lÃ­nea o multi lÃ­nea. En el caso de ser multi lÃ­nea, estas conservarÃ¡n todos los caracteres de espacio y salto de lÃ­nea contenidos en el _string_. El caracter de comilla simple (`'`) no es significativo para _Wren_.

Las strings pueden contener caracteres unicode en http://utf8everywhere.org/[UTF-8], como tambiÃ©n caracteres no vÃ¡lidos para _UTF-8_. 

AdemÃ¡s son inmutables. El string *"porotos"* no podrÃ¡ ser modificado (cambiando sus caracteres) luego de su creaciÃ³n.

Un string puede contener los siguientes valores:

- Una cadena de texto compuesto por una secuencia de puntos de cÃ³digo textuales (textual code point).
- Una cadena iterable compuesta por una secuencia de puntos de cÃ³digo numÃ©rico (numeric code point).
- Un arreglo simple de bytes indexeables.


### String de una lÃ­nea

```js
"Solo es necesario comillas dobles"
```

### String multi lÃ­nea

_Wren_ permite string multi lÃ­neas utilizando el mismo caracter de comillas dobles (`"`) de las strings de una sola lÃ­nea. 

```js
"
 Todo esto es una string multi lÃ­nea
 Wren esperarÃ¡ hasta que aparezca 
 la siguiente comilla doble.
 Los strings multi lÃ­nea en Wren guardan tanto espacios como saltos de lÃ­nea en su interior.
 (no son omitidos).
"
```

### Contando el largo del string

Si utilizamos la propiedad `count` podremos obtener el largo de un string.

Por ejemplo `"hola".count` devolverÃ¡ `4`. Hay que tener cuidado con los caracteres unicode (emojis), ya que el largo dependerÃ¡ de lo que se estÃ© contando. _Wren_ cuenta los puntos de cÃ³digo (code point) unicode, por que todos los strings estÃ¡n bajo _UTF-8_ (similar al comportamiento de https://www.ruby-lang.org/en/[_Ruby_] y https://www.python.org/[_Python 3_]).

```js

System.print("a".count) // Retorna 1.
System.print("a".bytes.count) // Retorna 1 (Parte de la tabla ASCII original).

System.print("Ã±".count) // Retorna 1.
System.print("Ã±".bytes.count) // Retorna 2.

System.print("ğŸ‘¹".count) // Retorna 1.
System.print("ğŸ‘¹".bytes.count) // Retorna 4.

System.print("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦".count) // Retorna 7 al contar la unidades de cÃ³digo de Unicode
System.print("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦".bytes.count) // Retorna 25 al contar los bytes UTF-8
```

`System.print("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦".count)` retorna 7 por que se estÃ¡ contando las unidades de cÃ³digo de unicode, es decir, el emoji ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ estÃ¡ formado por los siguientes caracteres : ğŸ‘¨ + caracter de uniÃ³n de ancho cero + ğŸ‘© + caracter de uniÃ³n de ancho cero + ğŸ‘§ + caracter de uniÃ³n de ancho cero + ğŸ‘¦.

`System.print("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦".bytes.count)` retorna 25 por que estÃ¡ contando los bytes necesarios para almacenar estos caracteres. bytes es una secuencia de caracteres en C, lo que permite utilizar los Strings para almacenar informaciÃ³n en binario.

Hay dos formas de contar adicionales que _Wren_ no soporta. La primera es contar por unidades de cÃ³digo _UTF-16_ y la otra es considerar los emojis compuestos como una unidad.

El string "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" deberÃ­a ser de largo 11 para la codificaciÃ³n _UTF-16_. Mientras que deberÃ­a ser de largo 1 si lo consideramos como un caracter singular (lo que percibe el usuario). SegÃºn los amigos de http://utf8everywhere.org/[UTF-8 Everywhere] contar de estas formas es poco productivo, ya que lo que importa es realmente los code units (unidades de cÃ³digo) _UTF-8_ que se tiene al escribir un string. Por lo que _Wren_ tiene un comportamiento adecuado. De todas formas ese tipo de conversiones y conteo podrÃ­a programarse con cÃ³digos externos a _Wren_. MÃ¡s detalles en el https://www.unicode.org/glossary/[Glosario Unicode].

### UniÃ³n e interpolaciÃ³n de strings

Si deseamos unir varios strings o incluir datos dentro de ellos podemos utilizar las siguientes operaciones: `+` y `%()`.

- `"Hola" + "Wren"`: Crea un nuevo string con la uniÃ³n de `Hola` y `Wren`. EntregarÃ¡ `HolaWren`. Es necesario que ambos objetos sean strings. Por ejemplo si se utiliza `"Hola" + 1` entregarÃ¡ un error similar a `Runtime error: Right operand must be a string.`. Para poder unirlos tendremos que utiliza el mÃ©todo getter `toString` del nÃºmero. `"Hola" + 1.toString`, retornando `Hola1`. 

El mÃ©todo `toString` es parte de la clase http://wren.io/modules/core/object.html[`Object`] la cual es la padre de todos los tipos de datos en _Wren_. Tanto nÃºmeros, booleanos, strings y listas son objetos que heredan de esta clase.

- `"Hola %(mundo)"`: Crea un string con la frase `Hola` y el contenido de la variable `mundo`.

La operaciÃ³n `%()` permite incluir cualquier instrucciÃ³n _Wren_ vÃ¡lida, la cual finalmente ejecutarÃ¡ el mÃ©todo `toString` para ser incluido en la cadena de caracteres. Esto incluso permite tener interpolaciones anidadas, pero eso se vuelve poco legible rÃ¡pidamente.

```js
// muestra: La respuesta es 42.
System.print("La respuesta es %(20 * 2 + 2).")

// muestra: wow 149
System.print("wow %((1..3).map {|n| n * n}.join())") 
```

### MultiplicaciÃ³n de strings

TambiÃ©n se pueden multiplicar para repetir la cadena de caracteres una cantidad de veces determinada.

```js
// muestra hola hola hola
System.print("hola " * 3)
```

  Si bien se pueden sumar (_+_) y multiplicar (_*_), no existe operaciones para resta (_-_) y division (_/_) dentro de una cadena de caracteres.

### Limitar el mÃ¡ximo de caracteres

El _String_ al ser una _Secuencia_ puede utilizar
sus mÃ©todos como _take()_ que permite obtener los 
elementos dentro de una secuencia. El mÃ©todo _join()_
es necesario para convertir nuevamente la secuencia
en un _String_.

```js
// muestra: hola
System.print("hola wren".take(4).join())
```

### Caracteres no imprimibles

Los caracteres no imprimibles o _Whitespace_ son aquellos
caracteres que el computador puede ver, pero son invisibles
para una persona. Los caracteres no imprimibles mÃ¡s comunes son el espacio (_" "_), la tabulaciÃ³n (_"\t"_) y el salto de lÃ­nea (_"\n"_). La combinaciÃ³n de dos caracteres _"\t"_ crea un nuevo espacio tabulado, mientras que la combinaciÃ³n de dos caracteres _"\n"_ crea una nueva lÃ­nea dentro del _String_. Â¡Puedes usarlos cuantÃ¡s veces y dÃ³nde desees!.

Prueba el siguiente cÃ³digo:

```js
System.print("Hola a todos")
System.print("\tHola a todos")
System.print("Hola\na todos")
System.print("\n\n\nHola\ta\ttodos")
```

#### Eliminando caracteres no imprimibles

Muchas veces al solicitar datos a un usuario, este puede incluir espacios adicionales al principio o final. Usualmente es buena idea eliminar estos caracteres no imprimibles antes de comenzar a procesar el dato.

```js
var nombre = " arturo "

// Elimina solamente espacio final
System.print(nombre.trimEnd())

// Elimina solamente espacio inicial
System.print(nombre.trimStart())

// Elimina espacio inicial y final
System.print(nombre.trim())
```

Si se necesita ver con mayor claridad lo que sucede
se puede usar el siguiente cÃ³digo:

```js
var nombre = " arturo "

// Elimina solamente espacio final
System.print("-" + nombre.trimEnd() + "-")

// Elimina solamente espacio inicial
System.print("-" + nombre.trimStart() + "-")

// Elimina espacio inicial y final
System.print("-" + nombre.trim() + "-")
```

### Caracteres de escape

Muchas veces se necesitan escribir caracteres especiales en un string. Por ejemplo si quisieramos escribir `"Hola Wren"` incluyendo las comillas, tendrÃ­amos que escribirlo de esta forma `"\"Hola Wren\""`. Esto incluirÃ¡ los caracteres de comillas dobles en la frase.

```js
"\0" // byte NUL (Nulo) : 0.
"\"" // Comillas dobles.
"\\" // Barra invertida.
"\%" // Signo porcentaje.
"\a" // Sonido de alarma.
"\b" // Retroceso.
"\f" // AlimentaciÃ³n de formularios.
"\n" // Salto de lÃ­nea.
"\r" // Retorno de carro.
"\t" // TabulaciÃ³n.
"\v" // TabulaciÃ³n vertical.
```

Para indicar caracteres especiales podemos utilizar `\u` (unicode para letras disponibles en los idiomas humanos), `\U` (unicode para letras especiales como emoji) y `\x` (bytes sin codificar).

- `System.print("\u0041\u0b83\u00DE")` = Aà®ƒÃ
- `System.print("\U0001F64A\U0001F680")` = ğŸ™ŠğŸš€
- `System.print("\x48\x69\x2e")` = Hi.

### Rangos de caracteres

Un _String_ es una _Secuencia_ de caracteres. Por lo que es posible obtener caracteres en posiciones especÃ­ficas
utilizando rangos (_Range_). El Ã­ndice comieza contando
desde cero para contar desde el principio de la cadena y puede tener valores negativos para contar
desde el final de la cadena.

#### Caracter en posiciÃ³n especÃ­fica

```js
// muestra: h
System.print("hola wren"[0])

// muestra: n
System.print("hola wren"[-1])
```

#### Rango de caracteres dentro de una cadena

```js
// muestra: la
System.print("hola wren"[2..3])
```

#### Invertir una cadena de caracteres

```js
// muestra: nerw aloh
System.print("hola wren"[-1..0])
```

### Ejercicios

include::exercises/chapter-3/donas/donas.adoc[]
